<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta http-equiv=Content-Security-Policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self' https://www.dropbox.com https://*.dl.dropboxusercontent.com https://photos.app.goo.gl https://drive.google.com https://photos.google.com https://video-downloads.googleusercontent.com https://*.googleusercontent.com https://*.googlevideo.com https://youtube.googleapis.com; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self' https://w.soundcloud.com https://www.youtube.com https://www.youtube-nocookie.com https://www.dropbox.com http://localhost https://www.dropbox.com http://darvein.local https://disqus.com; img-src 'self' https://photos.google.com https://lh3.googleusercontent.com https://www.dropbox.com https://*.dl.dropboxusercontent.com https://*.disqus.com https://c.disquscdn.com; object-src https://lh3.googleusercontent.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/ https://c.disquscdn.com; script-src 'self' 'unsafe-inline' https://www.google-analytics.com https://cdnjs.cloudflare.com https://www.googletagmanager.com https://www.dropbox.com http://localhost http://darvein.local https://drv21.disqus.com https://c.disquscdn.com; prefetch-src 'self' https://youtube.googleapis.com; connect-src 'self' https://www.google-analytics.com https://links.services.disqus.com;"><meta name=author content="Dennis Ruiz"><meta name=description content="Introduction to Google Chrome Based browsers based in chromium:
Brave browser Vivaldi Edge Steam Chrome uses: apple webkit, mozilla firefox? and part of chromium project
google foked webkit and named it Blink Engine Techniques of explotations Semantic Equivalent Transform (SET): program transforming JS seed generates new JSes translates: a.js -> (ast, mutate) -> b.js builtins, methods, scope, variable, type, signature loopenize (for, while), functionize, empty loop, garbage collection, nontype based, conditionize, repeat fuzzers?"><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="Introduction to Google Chrome Based browsers based in chromium:
Brave browser Vivaldi Edge Steam Chrome uses: apple webkit, mozilla firefox? and part of chromium project
google foked webkit and named it Blink Engine Techniques of explotations Semantic Equivalent Transform (SET): program transforming JS seed generates new JSes translates: a.js -> (ast, mutate) -> b.js builtins, methods, scope, variable, type, signature loopenize (for, while), functionize, empty loop, garbage collection, nontype based, conditionize, repeat fuzzers?"><meta property="og:title" content><meta property="og:description" content="Introduction to Google Chrome Based browsers based in chromium:
Brave browser Vivaldi Edge Steam Chrome uses: apple webkit, mozilla firefox? and part of chromium project
google foked webkit and named it Blink Engine Techniques of explotations Semantic Equivalent Transform (SET): program transforming JS seed generates new JSes translates: a.js -> (ast, mutate) -> b.js builtins, methods, scope, variable, type, signature loopenize (for, while), functionize, empty loop, garbage collection, nontype based, conditionize, repeat fuzzers?"><meta property="og:type" content="article"><meta property="og:url" content="https://www.darvein.net/infosec/chromium/intro/"><meta property="article:section" content="infosec"><title>Introduction to Google Chrome </title><link rel=canonical href=https://www.darvein.net/infosec/chromium/intro/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.a1a7e7e7bd8b6629931805334fd6cf056ee6f154702847e6d597bbfe80446a0d.css integrity="sha256-oafn572LZimTGAUzT9bPBW7m8VRwKEfm1Ze7/oBEag0=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.39e41a7f16bdf8cb16e43cae7d714fa1016f1d2d2898a5b3f27f42c9979204e2.css integrity="sha256-OeQafxa9+MsW5DyufXFPoQFvHS0omKWz8n9CyZeSBOI=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/custom.min.7cf8a329bb485491ed5be45bd286916c655bf66e11e3fe4d82649437eae8b51b.css integrity="sha256-fPijKbtIVJHtW+Rb0oaRbGVb9m4R4/5NgmSUN+rotRs=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5><meta name=generator content="Hugo 0.120.4"></head><body class="preload-transitions colorscheme-dark"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Darvein
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/infosec/>Infosec</a></li><li class=navigation-item><a class=navigation-link href=/coding/>Coding</a></li><li class=navigation-item><a class=navigation-link href=/devops/>Devops</a></li></ul></section></nav><div class=content><section class="container page"><article><h1 id=introduction-to-google-chrome>Introduction to Google Chrome
<a class=heading-link href=#introduction-to-google-chrome><i class="fa fa-link" aria-hidden=true></i></a></h1><p>Based browsers based in chromium:</p><ul><li>Brave browser</li><li>Vivaldi</li><li>Edge</li><li>Steam</li></ul><p>Chrome uses: apple webkit, mozilla firefox? and part of chromium project</p><ul><li>google foked webkit and named it Blink Engine</li></ul><h2 id=techniques-of-explotations>Techniques of explotations
<a class=heading-link href=#techniques-of-explotations><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li>Semantic Equivalent Transform (SET): program transforming JS seed generates new JSes<ul><li>translates: a.js -> (ast, mutate) -> b.js<ul><li>builtins, methods, scope, variable, type, signature</li><li>loopenize (for, while), functionize, empty loop, garbage collection, nontype based, conditionize, repeat</li></ul></li><li>fuzzers?</li></ul></li><li>Advanced Exploitation Techinque<ul><li>OOB Exploitation<ul><li>Leak ArrayBuffer backing store</li></ul></li><li>V8 out-of-bound in Promise</li></ul></li><li>Chrome Sandbox Bypass<ul><li>Logical bug<ul><li>attack renderer</li><li>attack webview in privileged app</li></ul></li><li>Kernel<ul><li>win32k lockdown</li><li>CLFS</li></ul></li><li>Memory Corruption via IPC<ul><li>UAF scape sandbox<ul><li>indexedDB (api in browser?)</li></ul></li><li>IndexedDB IPC interfaces: IDBFactory, IDBDatabase, IDBCursor</li></ul></li></ul></li><li>Exploiting in windows<ul><li>limitations<ul><li>no CFG, many virtual function calls in C++, all we need is heap adddress to put ROP</li></ul></li></ul></li><li>ChromeOS<ul><li>Clang CFI enabled is different</li><li>no libs and library address</li></ul></li><li>Renderer process</li><li>Valid vulns for reward:<ul><li>sandbox scape</li><li>renderer RCE</li><li>universal XSS (local bypass or equivalent)</li><li>information leak</li></ul></li></ul><h2 id=rock-stars>Rock stars?
<a class=heading-link href=#rock-stars><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li>Zhen Feng</li><li>Gengming Liu</li></ul><h2 id=common-vulns>Common vulns
<a class=heading-link href=#common-vulns><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li>CVE-2020-16001: UAF in media : Khali Zhani</li><li>CVE-2020-16002: UAF in PDFium : Weipeng Jiang</li><li>CVE-2020-15999: heap overflow in Freetype : Sergei Glazunov</li><li>CVE-2016-5129: (TODO: Need to review this one)</li><li>CVE-2016-0193: (TODO: Need to review this one)</li><li>CVE-2016-5198: (TODO: Need to review this one)</li><li>CVE-2017-5053: out-of-bound access capability</li><li>CVE-2016-5197: arbitrary intent start in renderer</li><li>CVE-2019-5826: UAF in IndexedDB</li><li>CVE-2021-37975: v8 engine vuln</li><li>CVE-2021-37976: information leak in core</li><li>CVE-2021-37973: Use after free in Portals</li><li>CVE-2021-30632 & CVE-2021-30633: by anonymouse: use after free in Indexed DB API</li><li>CVE-2021-31956 is a Windows NTFS Elevation of Privilege (EoP) vulnerability<ul><li>CVE-2021-21224 to escape the Chromium sandbox</li><li>called PuzzleMaker by Kaspersky</li><li>Windows builds 18362, 18363, 19041, and 19042 (19H1–20H2). Build 19043 (21H1) is not targeted<ul><li>has harcoded syscalls</li></ul></li><li>Magnitude exploit kit (EK)</li></ul></li><li>CVE-2021-30573: UAF in GPU</li><li>CVE-2021-21220: pwn2own</li></ul><h2 id=chrome-possible-cves-from-2021>chrome possible cves from 2021
<a class=heading-link href=#chrome-possible-cves-from-2021><i class="fa fa-link" aria-hidden=true></i></a></h2><p>CVE-2021-21148 – February 4th, 2021
CVE-2021-21166 – March 2nd, 2021
CVE-2021-21193 – March 12th, 2021
CVE-2021-21220 – April 13th, 2021
CVE-2021-21224 – April 20th, 2021
CVE-2021-30551 – June 9th, 2021
CVE-2021-30554 – June 17th, 2021
CVE-2021-30554 – June 17th, 2021
CVE-2021-30563 – July 15th, 2021
CVE-2021-30632 & CVE-2021-30633 – Sept 13th, 2021
CVE-2021-37973 – Sept 24th, 2021
CVE-2021-37975 and CVE-2021-37976 – Oct, 13st, 2021</p><h2 id=references>References
<a class=heading-link href=#references><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li>Defcon talk &ldquo;The Most Secure Browser? Pwning Chrome from 2016 to 2019&rdquo;:
<a href="https://www.youtube.com/watch?v=OoL9nyu-f-Q&amp;t=1738s">https://www.youtube.com/watch?v=OoL9nyu-f-Q&amp;t=1738s</a></li><li><a href=https://github.com/0xcl>https://github.com/0xcl</a></li><li>Chrome security page:
<a href=https://sites.google.com/a/chromium.org/dev/Home/chromium-security>https://sites.google.com/a/chromium.org/dev/Home/chromium-security</a></li><li>Chrome releases page:
<a href=https://chromereleases.googleblog.com/>https://chromereleases.googleblog.com/</a></li><li>Hall of fame:
<a href=https://sites.google.com/a/chromium.org/dev/Home/chromium-security/hall-of-fame>https://sites.google.com/a/chromium.org/dev/Home/chromium-security/hall-of-fame</a></li><li>Chrome vulnerability reward program:
<a href=https://bughunters.google.com/about/rules/5745167867576320>https://bughunters.google.com/about/rules/5745167867576320</a></li><li>Source code:
<a href=https://source.chromium.org/chromium>https://source.chromium.org/chromium</a><ul><li>Chromium source code structure:
<a href=https://www.chromium.org/developers/how-tos/getting-around-the-chrome-source-code>https://www.chromium.org/developers/how-tos/getting-around-the-chrome-source-code</a></li></ul></li><li>Chromium for developers:
<a href=https://www.chromium.org/developers>https://www.chromium.org/developers</a></li><li>Web browser anatomy:
<a href="https://www.youtube.com/watch?v=PzzNuCk-e0Y">https://www.youtube.com/watch?v=PzzNuCk-e0Y</a></li></ul><h2 id=more-references>More references
<a class=heading-link href=#more-references><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li>Game of Chromes: Owning the Web with Zombie Chrome Extensions:
<a href="https://www.youtube.com/watch?v=UHwpusw6mPc">https://www.youtube.com/watch?v=UHwpusw6mPc</a></li><li><a href="https://www.youtube.com/watch?v=pkIBnDJPluY">https://www.youtube.com/watch?v=pkIBnDJPluY</a></li><li><a href="https://www.youtube.com/watch?v=DFPD9yI-C70">https://www.youtube.com/watch?v=DFPD9yI-C70</a></li><li><a href="https://www.youtube.com/watch?v=PlCu1NBuU4I">https://www.youtube.com/watch?v=PlCu1NBuU4I</a></li><li><a href="https://www.youtube.com/watch?v=vn7YIAiOnYw">https://www.youtube.com/watch?v=vn7YIAiOnYw</a></li><li><a href=https://en.wikipedia.org/wiki/Google_Chrome>https://en.wikipedia.org/wiki/Google_Chrome</a></li><li><a href=https://medium.com/swlh/my-take-on-chrome-sandbox-escape-exploit-chain-dbf5a616eec5>https://medium.com/swlh/my-take-on-chrome-sandbox-escape-exploit-chain-dbf5a616eec5</a></li><li><a href=https://googleprojectzero.blogspot.com/2019/04/virtually-unlimited-memory-escaping.html>https://googleprojectzero.blogspot.com/2019/04/virtually-unlimited-memory-escaping.html</a></li><li><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1755">https://bugs.chromium.org/p/project-zero/issues/detail?id=1755</a></li><li><a href=https://dev.chromium.org/developers/design-documents/multi-process-architecture>https://dev.chromium.org/developers/design-documents/multi-process-architecture</a></li><li><a href=https://docs.google.com/document/d/1aitSOucL0VHZa9Z2vbRJSyAIsAz24kX8LFByQ5xQnUg/edit>https://docs.google.com/document/d/1aitSOucL0VHZa9Z2vbRJSyAIsAz24kX8LFByQ5xQnUg/edit</a></li><li><a href=https://github.com/vngkv123/aSiagaming/tree/master/Chrome-v8-906043>https://github.com/vngkv123/aSiagaming/tree/master/Chrome-v8-906043</a></li><li><a href=https://chromium.googlesource.com/chromium/src.git/+/refs/heads/main/mojo/README.md>https://chromium.googlesource.com/chromium/src.git/+/refs/heads/main/mojo/README.md</a></li><li><a href=https://seclab.stanford.edu/websec/chromium/chromium-security-architecture.pdf>https://seclab.stanford.edu/websec/chromium/chromium-security-architecture.pdf</a></li><li><a href="https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=chrome">https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=chrome</a></li><li><a href=https://v8.dev/docs/profile-chromium>https://v8.dev/docs/profile-chromium</a></li><li><a href=https://securitylab.github.com/research/chromium-ipc-vulnerabilities/>https://securitylab.github.com/research/chromium-ipc-vulnerabilities/</a></li><li><a href=https://googleprojectzero.blogspot.com/2019/04/virtually-unlimited-memory-escaping.html>https://googleprojectzero.blogspot.com/2019/04/virtually-unlimited-memory-escaping.html</a></li><li><a href=https://www.powerofcommunity.net/poc2018/ned.pdf>https://www.powerofcommunity.net/poc2018/ned.pdf</a></li><li><a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1942#c7">https://bugs.chromium.org/p/project-zero/issues/detail?id=1942#c7</a></li><li><a href=https://developers.google.com/web/updates/2018/09/inside-browser-part1>https://developers.google.com/web/updates/2018/09/inside-browser-part1</a></li><li><a href=https://zicodeng.medium.com/explore-the-magic-behind-google-chrome-c3563dbd2739>https://zicodeng.medium.com/explore-the-magic-behind-google-chrome-c3563dbd2739</a></li><li><a href=https://www.chromium.org/developers/how-tos/get-the-code>https://www.chromium.org/developers/how-tos/get-the-code</a></li><li>what are the chrome CVES in 2021?</li><li>google chrome security page:
<a href=https://sites.google.com/a/chromium.org/dev/Home/chromium-security>https://sites.google.com/a/chromium.org/dev/Home/chromium-security</a></li><li>chaining exploits:
<a href=https://github.blog/2021-03-24-real-world-exploit-chains-explained/>https://github.blog/2021-03-24-real-world-exploit-chains-explained/</a><ul><li><a href=https://securitylab.github.com/research/one_day_short_of_a_fullchain_sbx/>https://securitylab.github.com/research/one_day_short_of_a_fullchain_sbx/</a></li><li><a href=https://securitylab.github.com/advisories/GHSL-2020-165-chrome/>https://securitylab.github.com/advisories/GHSL-2020-165-chrome/</a></li></ul></li><li><a href=https://github.com/obezuk/chrome-0day>https://github.com/obezuk/chrome-0day</a></li><li><a href=https://github.com/RedWifiTeam/Chrome-0Day-EXP>https://github.com/RedWifiTeam/Chrome-0Day-EXP</a></li><li><a href=https://github.com/AeolusTF/chrome-0day>https://github.com/AeolusTF/chrome-0day</a></li><li><a href=https://github.com/H4ckTh3W0r1d/Chrome-0day>https://github.com/H4ckTh3W0r1d/Chrome-0day</a></li><li><a href=https://github.com/77409/chrome-0day>https://github.com/77409/chrome-0day</a></li><li>build chromium:
<a href="https://www.youtube.com/watch?v=jeRKirsUq4k">https://www.youtube.com/watch?v=jeRKirsUq4k</a></li><li>anatomy of a web browser:
<a href="https://www.youtube.com/watch?v=PzzNuCk-e0Y">https://www.youtube.com/watch?v=PzzNuCk-e0Y</a></li><li>IPC:
<a href="https://www.youtube.com/watch?v=MMxtKq8UgwE">https://www.youtube.com/watch?v=MMxtKq8UgwE</a></li><li><a href="https://www.youtube.com/watch?v=0uejy9aCNbI">https://www.youtube.com/watch?v=0uejy9aCNbI</a></li><li><a href="https://www.youtube.com/watch?v=y6Uzinz3DRU">https://www.youtube.com/watch?v=y6Uzinz3DRU</a></li></ul><h2 id=cve-videos>CVE videos
<a class=heading-link href=#cve-videos><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li>Security researcher drops Chrome 0day exploit on Twitter, new xorg-server CVE & how was your day?:
<a href="https://www.youtube.com/watch?v=6qNjVGpl-fI">https://www.youtube.com/watch?v=6qNjVGpl-fI</a></li><li><a href="https://www.youtube.com/watch?v=7mqPDFb2svc">https://www.youtube.com/watch?v=7mqPDFb2svc</a></li><li><a href="https://www.youtube.com/watch?v=IRm3R-Gejcc">https://www.youtube.com/watch?v=IRm3R-Gejcc</a></li></ul><h2 id=interesting>Interesting
<a class=heading-link href=#interesting><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li>Check latest issues in chrome:
<a href="https://bugs.chromium.org/p/chromium/issues/list?q=type%3Abug-security%20os%3DAndroid%2Cios%2Clinux%2Cmac%2Cwindows%2Call%2Cchrome&amp;can=1">https://bugs.chromium.org/p/chromium/issues/list?q=type%3Abug-security%20os%3DAndroid%2Cios%2Clinux%2Cmac%2Cwindows%2Call%2Cchrome&amp;can=1</a></li></ul><h2 id=exploitation-mitigations>Exploitation mitigations
<a class=heading-link href=#exploitation-mitigations><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li>aslr</li><li>r-x</li><li>hardened heap</li></ul></article></section></div><footer class=footer><section class=container>©
2021 -
2024
Dennis Ruiz
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main><script src=/js/coder.min.236049395dc3682fb2719640872958e12f1f24067bb09c327b233e6290c7edac.js integrity="sha256-I2BJOV3DaC+ycZZAhylY4S8fJAZ7sJwyeyM+YpDH7aw="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-6CQZY8W0WD"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6CQZY8W0WD")</script><script>$(document).on("input propertychange paste change",".FilterSearch",function(){var n=$(this).val().toLowerCase(),s=$(this).closest("ul"),t=s.find("li:gt(0)");t.hide(),t.filter(function(){var e=$(this).text().toLowerCase();return e.indexOf(n)>=0}).show()})</script></body></html>