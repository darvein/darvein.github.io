<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta http-equiv=Content-Security-Policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self' https://www.dropbox.com https://*.dl.dropboxusercontent.com https://photos.app.goo.gl https://drive.google.com https://photos.google.com https://video-downloads.googleusercontent.com https://*.googleusercontent.com https://*.googlevideo.com https://youtube.googleapis.com; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self' https://w.soundcloud.com https://www.youtube.com https://www.youtube-nocookie.com https://www.dropbox.com http://localhost https://www.dropbox.com http://darvein.local https://disqus.com; img-src 'self' https://photos.google.com https://lh3.googleusercontent.com https://www.dropbox.com https://*.dl.dropboxusercontent.com https://*.disqus.com https://c.disquscdn.com; object-src https://lh3.googleusercontent.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/ https://c.disquscdn.com; script-src 'self' 'unsafe-inline' https://www.google-analytics.com https://cdnjs.cloudflare.com https://www.googletagmanager.com https://www.dropbox.com http://localhost http://darvein.local https://drv21.disqus.com https://c.disquscdn.com; prefetch-src 'self' https://youtube.googleapis.com; connect-src 'self' https://www.google-analytics.com https://links.services.disqus.com;"><meta name=author content="Dennis Ruiz"><meta name=description content="VPC Basics supports hardware virtual private network VPN for on-prems datacenters limit of 5 VPCs by default components: igw or vpg (vpn) routing tables nACLs subnets vpc region 1 subnet = 1 AZ LAN options: 10.0.0.0 - 10.255.255.255 (10/8) 172.16.0.0 - 172.31.255.255 (172.16/12) 192.168.0.0 - 192.168.255.255 (192.168/16) Only 1 IGW per VPC ** SGs are stateful. NACLs are stateless. instead of a igw a NAT Instance (ec2) can be used or just a Nat gateway (EIP) network traffic logs can go to cloudwatch via VPC FLowLogs option enabled (not peered vpcs) vpc flow can be created at VPC, subnet and network intf levesl VPC endpoints can be enabled to allow internal aws ec2 instances to connect to other aws services (s3) vulnerability scans are not allowed, even on your own VPC when creating a vpc it by defaults create: ACL, SGs and a RT Egress-Only, allows vpc based ipv6 access to the internet, but prevents outisde ipv6 connections to the vpc Subneting on a VPC, the first 4 IP addrs and the latest one are reserved for AWS ."><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="VPC Basics supports hardware virtual private network VPN for on-prems datacenters limit of 5 VPCs by default components: igw or vpg (vpn) routing tables nACLs subnets vpc region 1 subnet = 1 AZ LAN options: 10.0.0.0 - 10.255.255.255 (10/8) 172.16.0.0 - 172.31.255.255 (172.16/12) 192.168.0.0 - 192.168.255.255 (192.168/16) Only 1 IGW per VPC ** SGs are stateful. NACLs are stateless. instead of a igw a NAT Instance (ec2) can be used or just a Nat gateway (EIP) network traffic logs can go to cloudwatch via VPC FLowLogs option enabled (not peered vpcs) vpc flow can be created at VPC, subnet and network intf levesl VPC endpoints can be enabled to allow internal aws ec2 instances to connect to other aws services (s3) vulnerability scans are not allowed, even on your own VPC when creating a vpc it by defaults create: ACL, SGs and a RT Egress-Only, allows vpc based ipv6 access to the internet, but prevents outisde ipv6 connections to the vpc Subneting on a VPC, the first 4 IP addrs and the latest one are reserved for AWS ."><meta property="og:title" content><meta property="og:description" content="VPC Basics supports hardware virtual private network VPN for on-prems datacenters limit of 5 VPCs by default components: igw or vpg (vpn) routing tables nACLs subnets vpc region 1 subnet = 1 AZ LAN options: 10.0.0.0 - 10.255.255.255 (10/8) 172.16.0.0 - 172.31.255.255 (172.16/12) 192.168.0.0 - 192.168.255.255 (192.168/16) Only 1 IGW per VPC ** SGs are stateful. NACLs are stateless. instead of a igw a NAT Instance (ec2) can be used or just a Nat gateway (EIP) network traffic logs can go to cloudwatch via VPC FLowLogs option enabled (not peered vpcs) vpc flow can be created at VPC, subnet and network intf levesl VPC endpoints can be enabled to allow internal aws ec2 instances to connect to other aws services (s3) vulnerability scans are not allowed, even on your own VPC when creating a vpc it by defaults create: ACL, SGs and a RT Egress-Only, allows vpc based ipv6 access to the internet, but prevents outisde ipv6 connections to the vpc Subneting on a VPC, the first 4 IP addrs and the latest one are reserved for AWS ."><meta property="og:type" content="article"><meta property="og:url" content="https://www.darvein.net/devops/aws/aws-sa-assoc/vpc/"><meta property="article:section" content="devops"><title>VPC </title><link rel=canonical href=https://www.darvein.net/devops/aws/aws-sa-assoc/vpc/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.a1a7e7e7bd8b6629931805334fd6cf056ee6f154702847e6d597bbfe80446a0d.css integrity="sha256-oafn572LZimTGAUzT9bPBW7m8VRwKEfm1Ze7/oBEag0=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.39e41a7f16bdf8cb16e43cae7d714fa1016f1d2d2898a5b3f27f42c9979204e2.css integrity="sha256-OeQafxa9+MsW5DyufXFPoQFvHS0omKWz8n9CyZeSBOI=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/custom.min.7cf8a329bb485491ed5be45bd286916c655bf66e11e3fe4d82649437eae8b51b.css integrity="sha256-fPijKbtIVJHtW+Rb0oaRbGVb9m4R4/5NgmSUN+rotRs=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5><meta name=generator content="Hugo 0.120.4"></head><body class="preload-transitions colorscheme-dark"><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Darvein
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/infosec/>Infosec</a></li><li class=navigation-item><a class=navigation-link href=/coding/>Coding</a></li><li class=navigation-item><a class=navigation-link href=/devops/>Devops</a></li></ul></section></nav><div class=content><section class="container page"><article><h1 id=vpc>VPC
<a class=heading-link href=#vpc><i class="fa fa-link" aria-hidden=true></i></a></h1><h2 id=basics>Basics
<a class=heading-link href=#basics><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li>supports hardware virtual private network VPN for on-prems datacenters</li><li>limit of 5 VPCs by default</li><li>components:<ul><li>igw or vpg (vpn)</li><li>routing tables</li><li>nACLs</li><li>subnets</li><li>vpc</li><li>region</li></ul></li><li>1 subnet = 1 AZ</li><li>LAN options:<ul><li>10.0.0.0 - 10.255.255.255 (10/8)</li><li>172.16.0.0 - 172.31.255.255 (172.16/12)</li><li>192.168.0.0 - 192.168.255.255 (192.168/16)</li></ul></li><li>Only 1 IGW per VPC</li><li>** SGs are stateful. NACLs are stateless.</li><li>instead of a igw a NAT Instance (ec2) can be used or just a Nat gateway (EIP)</li><li>network traffic logs can go to cloudwatch via VPC FLowLogs option enabled (not peered vpcs)</li><li>vpc flow can be created at VPC, subnet and network intf levesl</li><li>VPC endpoints can be enabled to allow internal aws ec2 instances to connect to other aws services (s3)</li><li>vulnerability scans are not allowed, even on your own VPC</li><li>when creating a vpc it by defaults create: ACL, SGs and a RT</li><li>Egress-Only, allows vpc based ipv6 access to the internet, but prevents outisde ipv6 connections to the vpc</li></ul><h2 id=subneting>Subneting
<a class=heading-link href=#subneting><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li>on a VPC, the first 4 IP addrs and the latest one are reserved for AWS<ul><li>.0 network addr</li><li>.1 aws vpc router</li><li>.2 aws dns server</li><li>.3 aws for the future</li><li>.255 network broadcast</li></ul></li><li>At least two subnets should be public (multi AZs)</li></ul><h2 id=vpc-peering>VPC Peering
<a class=heading-link href=#vpc-peering><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li>connect a vpc with another via a direct network route using private IP addrs</li><li>VPCs can be from different aws accounts</li><li>VPCs are not transitives only 1-1</li></ul><h2 id=nat-gateways>NAT Gateways
<a class=heading-link href=#nat-gateways><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li>IGW allows in and out access to internet to the public subnets and the resources on it</li><li>NAT gateway (and NAT instance) allows resources from a subnet access to internet but no the other way around</li><li>SGs cannot be associated with a NAT gateway</li><li>A Nat gateway operates only in one AZ, it is needed one on each AZ</li><li>scales up automatically to 10Gbps</li><li>automatic ip addr assignment</li></ul><h3 id=bastion-host>Bastion host
<a class=heading-link href=#bastion-host><i class="fa fa-link" aria-hidden=true></i></a></h3><ul><li>it has to be in the public subnet ?</li></ul><h2 id=nalcs>NALCs
<a class=heading-link href=#nalcs><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li>inbound and outbound rules definition</li><li>by default deny anything and deny everythingA</li><li>ephemeral ports 32768-65535. There may be some differences on LBs and Windows Server.</li><li>rules are numered on 100 range steps for the ALLOW rules. The inner options would be for DENY rules.</li></ul><h2 id=vpn>VPN
<a class=heading-link href=#vpn><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li>requires at least a VPG and a Customer gateway</li></ul></article></section></div><footer class=footer><section class=container>©
2021 -
2024
Dennis Ruiz
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main><script src=/js/coder.min.236049395dc3682fb2719640872958e12f1f24067bb09c327b233e6290c7edac.js integrity="sha256-I2BJOV3DaC+ycZZAhylY4S8fJAZ7sJwyeyM+YpDH7aw="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-6CQZY8W0WD"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6CQZY8W0WD")</script><script>$(document).on("input propertychange paste change",".FilterSearch",function(){var n=$(this).val().toLowerCase(),s=$(this).closest("ul"),t=s.find("li:gt(0)");t.hide(),t.filter(function(){var e=$(this).text().toLowerCase();return e.indexOf(n)>=0}).show()})</script></body></html>