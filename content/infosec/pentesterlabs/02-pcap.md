# PCAPs

URL: https://pentesterlab.com/badges/pcap

## PCAPs

### 01 to 09, 11 to 20, 22 to 26
notes:
- just load the pcap and on wireshark go to "Follow TCP Stream"
- `tcp.stream eq 0` to filter sequence of tcp packages
- 08 ex data is base64-ed

### 10
notes
- the capture has an email and an attachment, select the `begin` til `end` to get the attachment file:
```bash
~/tmp/mailfile $ vim mailfile
~/tmp/mailfile $ uudecode mailfile
~/tmp/mailfile $ ls
mailfile  the_key.zip
~/tmp/mailfile $ unzip the_key.zip
Archive:  the_key.zip
 extracting: tmp/attachment.txt
~/tmp/mailfile $ ls
mailfile  the_key.zip  tmp
~/tmp/mailfile $ ls tmp
attachment.txt
~/tmp/mailfile $ cat tmp/attachment.txt
The key is 84e1cf5c-7df9-4ec1-8cba-c69287f2646f
```

### 21
notes
- in wireshark download the follow streaam package as RAW, then using vim remove the http headers

```bash
~/tmp/test1 $ ls
package_raw
~/tmp/test1 $ vim package_raw
~/tmp/test1 $ printf "\x1f\x8b\x08\x00\x00\x00\x00\x00"  | cat - package_raw | gunzip
<html>
  <head>
    <title>Welcome to PentesterLab</title>
  </head>
  <body>
    <h1>The key is 60ae2a24-78fa-4852-88b4-26df795d78c6!</h1>
  </body>
</html>

gzip: stdin: unexpected end of file

```

### 27
Notes
- in IoT devices , they do query DNS' but trusting an unsecure `Transaction ID`, usually 0, or increasing number
- in wireshark check for transaction ids: `dns.id==0`

### 28
Notes
- identify dns response attacks, make sure transaction ids are equal for server and client
- make sure to follow sequences `udp.stream eq 0`

### 29, 30,  31
Notes
- Check the TLS data, the certificate details, extension server name (SNI)

### 32
Notes
- encrypted http pacakges can be seen by using a valid .PEM file and decrypt TLS packges using RSA optionA
- exploitable as the server doesn't have enabled `forward ecrecy`

### 33
